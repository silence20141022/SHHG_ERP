<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN"> <html> <head> <meta http-equiv="Content-Type" content="text/html; charset=gb2312"> <script type="text/javascript" src="dialog.js"></script> <script type="text/javascript">document.write("<link href='../skin/"+config.Skin+"/dialog.css' type='text/css' rel='stylesheet'>");var bA=lang["DlgFR"];document.write("<title>"+bA+"</title>");var dZ;var aV;if(t.bu){if(O.J.selection.type=="Control"){aV=O.J.body.createTextRange();aV.collapse(true);}else{aV=O.J.selection.createRange();}}function vf(){var vO=0;var wg=0;var vT=0;if($("d_matchcase").checked){wg=4;}if($("d_matchword").checked){vT=2;}vO=wg+vT;return(vO);};function sa(){if($("d_search").value.length<1){alert(lang["DlgFRNoKey"]);return false;}else{return true;}};function qA(){if(!sa()){return;}var ny=$("d_search").value;if(t.bu){aV.collapse(false);if(aV.findText(ny,1000000000,vf())){aV.select();}else{var rS=confirm(lang["DlgFRRestart"]);if(rS){aV.expand("textedit");aV.collapse();aV.select();qA();}}}else{if(aV){dZ=O.aG.getSelection();if(dZ.rangeCount>0){dZ.removeAllRanges();}dZ.addRange(aV);}var rz=($("d_matchcase").checked);var rV=($("d_matchword").checked);if(O.aG.find(ny,rz,false,false,rV)){dZ=O.aG.getSelection();aV=dZ.getRangeAt(0);}else{var rS=confirm(lang["DlgFRRestart"]);if(rS){if(dZ){aV=null;dZ.removeAllRanges();}qA();}}}};function Al(){if(!sa()){return;}var iE=$("d_replace").value;if(t.bu){aV.text=iE;}else{if(aV){aV.deleteContents();if(iE!=""){var bx=O.J.createTextNode(iE);aV.insertNode(bx);aV.selectNode(bx);aV.collapse(false);}}}qA();};function Aj(){if(!sa()){return;}var ny=$("d_search").value;var iE=$("d_replace").value;var pR=0;var qq="";if(t.bu){aV.expand("textedit");aV.collapse();aV.select();while(aV.findText(ny,1000000000,vf())){aV.select();aV.text=iE;pR++;}}else{var rz=($("d_matchcase").checked);var rV=($("d_matchword").checked);dZ=O.aG.getSelection();dZ.removeAllRanges();while(O.aG.find(ny,rz,false,false,rV)){dZ=O.aG.getSelection();aV=dZ.getRangeAt(0);aV.deleteContents();if(iE!=""){var bx=O.J.createTextNode(iE);aV.insertNode(bx);aV.selectNode(bx);aV.collapse(false);}dZ.removeAllRanges();dZ.addRange(aV);pR++;}}if(pR==0){qq=lang["DlgFRNoFound"]}else{qq=pR+" "+lang["DlgFRReplaceOK"];}alert(qq);};function bm(){lang.aN(document);parent.aR(bA);}</script> </head> <body onload="bm()"> <table border=0 cellpadding=0 cellspacing=5 id=tabDialogSize><tr><td> <table cellspacing="0" cellpadding="0" border="0" align=center> <tr> <td valign="top" align="left" nowrap width="60%"> <label for="d_search"><span lang=DlgFRSearchKey></span></label><br> <input type=text size=25 id="d_search"><br> <label for="d_replace"><span lang=DlgFRReplaceKey></span></label><br> <input type=text size=25 id="d_replace"><br> <input type=checkbox id="d_matchcase"><label for="d_matchcase"><span lang=DlgFRMatchCase></span></label><br> <input type=checkbox id="d_matchword"><label for="d_matchword"><span lang=DlgFRMatchWord></span></label> </td> <td width="5%"> <td rowspan="2" valign="bottom" width="35%"> <table border=0 cellpadding=0 cellspacing=5 width="100%" align=center> <tr><td><input type=button class="dlgBtnFind dlgBtn" name="btnFind" onClick="qA();" value="" lang=DlgFRFindNext></td></tr> <tr><td><input type=button class="dlgBtnFind dlgBtn" name="btnCancel" onClick="parent.bF()" value="" lang=DlgBtnClose></td></tr> <tr><td><input type=button class="dlgBtnFind dlgBtn" name="btnReplace" onClick="Al();" value="" lang=DlgFRReplace></td></tr> <tr><td><input type=button class="dlgBtnFind dlgBtn" name="btnReplaceall" onClick="Aj();" value="" lang=DlgFRReplaceAll></td></tr> </table> </td> </tr> </table> </td></tr></table> </body> </html> 