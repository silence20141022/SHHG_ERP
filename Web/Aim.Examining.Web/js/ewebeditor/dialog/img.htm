<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN"> <html> <head> <meta http-equiv="Content-Type" content="text/html; charset=gb2312"> <script type="text/javascript" src="dialog.js"></script> <script type="text/javascript">document.write("<link href='../skin/"+config.Skin+"/dialog.css' type='text/css' rel='stylesheet'>");var bj="INSERT";var au=lang["DlgComInsert"];var C;var wL;var bH="http://";var lf="";var fb="0";var cE="";var mC="";var aL="";var aF="";var bV="";var cO="";var cY="";var cB="";var cq="file";var dQ=((parseFloat(config.AllowImageSize)>0)?true:false);var wU=(((config.SYWZFlag=="2")||(config.SYTPFlag=="2"))?true:false);if(V.bC()=="Control"){C=V.aW();if(C.tagName=="IMG"&&dH(C,"_ewebeditor_fake_tag")==""){bj="MODI";au=lang["DlgComModify"];cq="url";bH=vo(C,"src");lf=dH(C,"alt");fb=dH(C,"border");cE=C.style.borderColor;mC=C.style.filter;aL=dH(C,"align");aF=jV(dY(C,"width"));bV=jV(dY(C,"height"));cO=dH(C,"vspace");cY=dH(C,"hspace");}}var bA=lang["DlgImg"]+"("+au+")";document.write("<title>"+bA+"</title>");function bm(){lang.aN(document);bQ($("d_filter"),mC);bQ($("d_align"),aL.toLowerCase());if(!dQ){cq="url";}RadioClick(cq);$("d_fromurl").value=bH;$("d_alt").value=lf;$("d_border").value=fb;$("d_bordercolor").value=cE;$("s_bordercolor").style.backgroundColor=cE;$("d_width").value=aF;$("d_height").value=bV;$("d_vspace").value=cO;$("d_hspace").value=cY;var mb=$("TD_Right");var hd=$("Fieldset_Right");var h1=mb.offsetHeight;var h2=hd.offsetHeight;if(h1>h2){if(t.bu){hd.style.height=h1+"px";}else{hd.style.height=(h1-2)+"px";}}fr();if($("d_fromurl")){if(t.bu){$("d_fromurl").onpropertychange=lT;}else{H.bM($("d_fromurl"),"input",lT);}}parent.aR(bA);};function lT(){if(t.bu){if(event.propertyName!='value'){return;}}var aE=$("d_fromurl").value;var n=aE.lastIndexOf(".");if(n>=1){if(aE.length>n+1){var cR="|"+aE.substr(n+1)+"|";if("|gif|jpg|jpeg|png|bmp|".indexOf(cR.toLowerCase())>=0){fr();return;}}}sT();};function RadioClick(cK){if(cK=="url"){$("d_fromurl").disabled=false;if(config.AllowBrowse=="1"){$("d_browse").disabled=false;}$("d_checkfromurl").checked=true;if(dQ){$("d_checkfromfile").checked=false;$("uploadfile").disabled=true;}}else{$("d_checkfromurl").checked=false;$("uploadfile").disabled=false;$("d_checkfromfile").checked=true;$("d_fromurl").disabled=true;if(config.AllowBrowse=="1"){$("d_browse").disabled=true;}}};function UploadError(ap){gV();RadioClick('file');$("divProcessing").style.display="none";try{dz($("uploadfile"),jT(ap,config.AllowImageExt,config.AllowImageSize));}catch(e){}};function UploadSaved(ps,xy){$("d_fromurl").value=ps;cB=xy;if(config.SLTMode=="0"&&config.SLTFlag=="2"){cB=ps;}dC();};function dC(){bH=$("d_fromurl").value;lf=$("d_alt").value;fb=$("d_border").value;cE=$("d_bordercolor").value;mC=$("d_filter").options[$("d_filter").selectedIndex].value;aL=$("d_align").value;aF=$("d_width").value;bV=$("d_height").value;cO=$("d_vspace").value;cY=$("d_hspace").value;if(bj=="MODI"){if(cB){ai(C,"src",cB);mK(C,"src",cB);}else{ai(C,"src",bH);mK(C,"src",bH);}ai(C,"alt",lf);ai(C,"border",fb);C.style.borderColor=cE;C.style.filter=mC;ai(C,"align",aL);C.style.width=aF;C.style.height=bV;ai(C,"width","");ai(C,"height","");ai(C,"vspace",cO);ai(C,"hspace",cY);if(cB){O.J.execCommand("CreateLink",false,bH);var ak=C.parentNode;if(ak.tagName=="A"){ai(ak,"target","_blank");ai(ak,"href",bH);mK(ak,"href",bH)}}}else{var K='';if(mC!=''){K=K+'filter:'+mC+';';}if(cE!=''){K=K+'border-color:'+cE+';';}if(aF!=""){K=K+'width:'+aF+';';}if(bV!=""){K=K+'height:'+bV+';';}if(K!=''){K=' style="'+K+'"';}if(cB){K='<img src="'+cB+'"'+K;}else{K='<img src="'+bH+'"'+K;}if(fb!=''){K=K+' border="'+fb+'"';}if(lf!=''){K=K+' alt="'+lf+'"';}if(aL!=''){K=K+' align="'+aL+'"';}if(cO!=''){K=K+' vspace="'+cO+'"';}if(cY!=''){K=K+' hspace="'+cY+'"';}K=K+'>';if(cB){K='<a href="'+bH+'" target="_blank">'+K+'</a>';}EWIN.insertHTML(K);}parent.pD();};var qF="";function ok(){$("d_border").value=fn($("d_border").value);$("d_width").value=fn($("d_width").value);$("d_height").value=fn($("d_height").value);$("d_vspace").value=fn($("d_vspace").value);$("d_hspace").value=fn($("d_hspace").value);if(!mH($("d_bordercolor").value)){dz($("d_bordercolor"),lang["DlgImgErrBorColor"]);return false;}if($("d_checkfromurl").checked){dC();}else{if(!iW($("uploadfile").value,config.AllowImageExt)){UploadError("ext");return false;}gW();$("divProcessing").style.display="";if(wU){if(qF==""){qF=document.myuploadform.action;}if($("d_syflag").checked){document.myuploadform.action=qF+"&syflag=1";}else{document.myuploadform.action=qF;}}document.myuploadform.submit();}};function gW(){$("d_checkfromfile").disabled=true;$("d_checkfromurl").disabled=true;$("d_fromurl").disabled=true;if(config.AllowBrowse=="1"){$("d_browse").disabled=true;}$("d_alt").disabled=true;$("d_border").disabled=true;$("d_bordercolor").disabled=true;$("d_filter").disabled=true;$("d_align").disabled=true;$("d_width").disabled=true;$("d_height").disabled=true;$("d_vspace").disabled=true;$("d_hspace").disabled=true;$("d_ok").disabled=true;};function gV(){$("d_checkfromfile").disabled=false;$("d_checkfromurl").disabled=false;$("d_fromurl").disabled=false;if(config.AllowBrowse=="1"){$("d_browse").disabled=false;}$("d_alt").disabled=false;$("d_border").disabled=false;$("d_bordercolor").disabled=false;$("d_filter").disabled=false;$("d_align").disabled=false;$("d_width").disabled=false;$("d_height").disabled=false;$("d_vspace").disabled=false;$("d_hspace").disabled=false;$("d_ok").disabled=false;};function fr(){var aE="";if($("d_checkfromurl").checked){aE=$("d_fromurl").value;if(config.BaseHref!=""){aE=qb(aE);}}else{aE=$("uploadfile").value;}if(aE.lastIndexOf(".")<=0){sT();return;}if(!t.bu){if($("uploadfile").files.length>0){aE=$("uploadfile").files[0].getAsDataURL();}}var wI=false;if((dQ)&&(t.gd)){if($("d_checkfromfile").checked){wI=true;}}if(aE){if(wI){wh(aE);}else{var img=new Image();img.onload=function(){vw(img.width,img.height,img.src);};img.onerror=sT;img.src=aE;}}else{$("tdPreview").innerHTML="";}};function vw(w,h,aE){var fl=$("tdPreview").offsetWidth;var gI=$("tdPreview").offsetHeight;var sw,fB;if((w>fl)||(h>gI)){var nw=fl/w;var iC=gI/h;if(nw>iC){fB=gI;sw=w*iC;}else{sw=fl;fB=h*nw;}}else{sw=w;fB=h;}$("tdPreview").innerHTML="<img border=0 src='"+aE+"' width='"+sw+"' height='"+fB+"' style=\"filter:"+$("d_filter").value+"\">";$("tdPreviewSize").innerHTML=w+" * "+h;wm(w,h);};function sT(){$("tdPreview").innerHTML="";$("tdPreviewSize").innerHTML="";};function wh(url){var fl=$("tdPreview").offsetWidth;var gI=$("tdPreview").offsetHeight;$("tdPreview").innerHTML="<div id=imgPreviewDiv style=\"filter : progid:DXImageTransform.Microsoft.AlphaImageLoader(sizingMethod=image) "+$("d_filter").value+";WIDTH:10px; HEIGHT:10px;\"></div>";$("imgPreviewDiv").filters.item("DXImageTransform.Microsoft.AlphaImageLoader").src=url;var w=$("imgPreviewDiv").offsetWidth;var h=$("imgPreviewDiv").offsetHeight;var sw,fB;if((w>fl)||(h>gI)){var nw=fl/w;var iC=gI/h;if(nw>iC){fB=gI;sw=w*iC;}else{sw=fl;fB=h*nw;}}else{sw=w;fB=h;}$("imgPreviewDiv").style.width=sw;$("imgPreviewDiv").style.height=fB;$("imgPreviewDiv").filters.item("DXImageTransform.Microsoft.AlphaImageLoader").sizingMethod='scale';$("tdPreviewSize").innerHTML=w+" * "+h;wm(w,h);};function wm(w,h){if(config.SLTFlag!="2"){return;}var qH=parseInt(config.SLTMinSize);var im=parseInt(config.SLTOkSize);var tw,th;switch(config.SLTCheckFlag){case "0":if(w<=qH){return;}tw=im;th=parseInt(h*(im/w));break;case "1":if(h<=qH){return;}tw=parseInt(w*(im/h));th=im;break;case "2":if(w<=qH&&h<=qH){return;}if(w>h){tw=im;th=parseInt(h*(im/w));}else{tw=parseInt(w*(im/h));th=im;}break;}$("d_width").value=tw+"";$("d_height").value=th+"";};function lK(cG,iH,dk){if(dk=="tab_mfu"){DLGMFU.Load("image",$(dk),DLGTab.fV[1].Width+"px",DLGTab.fV[1].Height+"px");}}</script> <script event="OnCancel(ap)" for="eWebEditorMFU">if(ap==""){parent.bF();}</script> <script event="OnUpload(ap, ah)" for="eWebEditorMFU">if(ap=="endall"||ap=="endapart"){var K="";var ei=ah.split("|");for(var i=0;i<ei.length;i++){var a=ei[i].split("::");if(a.length==3&&a[1]!=""){var cf=a[0].substr(a[0].lastIndexOf("\\")+1);if(a[2]==""){K+="<img border=0 src='"+a[1]+"'><br>";EWIN.addUploadFile(cf,a[1]);}else{K+="<a href='"+a[1]+"' target='_blank'><img border=0 src='"+a[2]+"'></a><br>";EWIN.addUploadFile(cf,a[1]);EWIN.addUploadFile(cf,a[2]);}}}EWIN.insertHTML(K);parent.ax();}</script> </head> <body onload="bm()"> <table border=0 cellpadding=0 cellspacing=5 id=tabDialogSize><tr><td> <script type="text/javascript">if(config.MFUEnable=="1"){DLGTab.kh([[lang["DlgComTabNormal"],"tab_normal"],[lang["DlgComTabMFU"],"tab_mfu"]]);}</script> <table id="tab_normal" border=0 cellpadding=0 cellspacing=5 align=center> <tr valign=top><td> <table border=0 cellpadding=0 cellspacing=0 align=center width="100%"> <tr> <td> <fieldset> <legend><span lang=DlgImgSource></span></legend> <table border=0 cellpadding=5 cellspacing=0 width="100%"> <tr><td> <table border=0 cellpadding=0 cellspacing=0 width="300px"><tr><td></td></tr></table> <table border=0 cellpadding=0 cellspacing=2 width="100%"> <script type="text/javascript">if(dQ){document.write("<tr>");document.write("<td noWrap width=\"20%\"><input type=radio id=\"d_checkfromfile\" value=\"1\" onclick=\"RadioClick('file')\"><label for=d_checkfromfile>"+lang["DlgFromFile"]+"</label>:</td>");document.write("<td noWrap width=\"80%\">");document.write(nr("image"));document.write("</td>");document.write("</tr>");}</script> <tr> <td noWrap width="20%"><input type=radio id="d_checkfromurl" value="1" onclick="RadioClick('url')"><label for=d_checkfromurl><span lang=DlgFromUrl></span></label>:</td> <td noWrap width="80%"> <script type="text/javascript">if(config.AllowBrowse=="1"){document.write("<table border=0 cellpadding=0 cellspacing=0 width='100%'><tr><td width='100%'><input type=text id='d_fromurl' style='width:100%' size=20 value=''></td><td><input class='dlgBtnBrowse' type=button id='d_browse' onclick=\"jO('image','fromurl')\" value='"+lang["DlgBtnBrowse"]+"' align=absmiddle></td></tr></table>");}else{document.write("<input type=text id='d_fromurl' style='width:100%' size=30 value=''>");}</script> </td> </tr> </table> </td></tr> </table> </fieldset> </td> </tr> <tr><td height=5></td></tr> <tr> <td> <fieldset> <legend><span lang=DlgImgEffect></span></legend> <table border=0 cellpadding=5 cellspacing=0 width="100%"> <tr><td> <table border=0 cellpadding=0 cellspacing=2 width="100%"> <tr> <td noWrap width="20%"><span lang=DlgImgAlt></span>:</td> <td noWrap width="80%" colspan=4><input type=text id=d_alt size=10 value="" style="width:100%"></td> </tr> <tr> <td noWrap width="20%"><span lang=DlgImgBorder></span>:</td> <td noWrap width="29%"><input style="width:80px" type=text id=d_border size=10 value="" onkeydown="fE(event);"></td> <td width="2%">&nbsp;</td> <td noWrap width="20%"><span lang=DlgImgBorderColor></span>:</td> <td noWrap width="29%"><input style="width:62px" type=text id=d_bordercolor size=7 value=""><img border=0 src="images/rect.gif" width=18 style="cursor:hand" id=s_bordercolor onclick="gb('bordercolor')" align=absmiddle></td> </tr> <tr> <td noWrap width="20%"><span lang=DlgImgSpecEffect></span>:</td> <td noWrap width="29%"> <select id=d_filter size=1 style="width:80px" onchange="fr()"> <option value='' selected lang=DlgComNone></option> <option value='Alpha(Opacity=50)' lang=DlgImgAlpha1></option> <option value='Alpha(Opacity=0, FinishOpacity=100, Style=1, StartX=0, StartY=0, FinishX=100, FinishY=140)' lang=DlgImgAlpha2></option> <option value='Alpha(Opacity=10, FinishOpacity=100, Style=2, StartX=30, StartY=30, FinishX=200, FinishY=200)' lang=DlgImgAlpha3></option> <option value='blur(add=1,direction=14,strength=15)' lang=DlgImgBlur1></option> <option value='blur(add=true,direction=45,strength=30)' lang=DlgImgBlur2></option> <option value='Wave(Add=0, Freq=60, LightStrength=1, Phase=0, Strength=3)' lang=DlgImgWave></option> <option value='gray' lang=DlgImgGray></option> <option value='Chroma(Color=#FFFFFF)' lang=DlgImgChroma></option> <option value='DropShadow(Color=#999999, OffX=7, OffY=4, Positive=1)' lang=DlgImgDropShadow></option> <option value='Shadow(Color=#999999, Direction=45)' lang=DlgImgShadow></option> <option value='Glow(Color=#ff9900, Strength=5)' lang=DlgImgGlow></option> <option value='flipv' lang=DlgImgFlipv></option> <option value='fliph' lang=DlgImgFliph></option> <option value='grays' lang=DlgImgGrays></option> <option value='xray' lang=DlgImgXray></option> <option value='invert' lang=DlgImgInvert></option> </select> </td> <td width="2%">&nbsp;</td> <td noWrap width="20%"><span lang=DlgAlign></span>:</td> <td noWrap width="29%"> <select id=d_align size=1 style="width:80px"> <option value='' selected lang=DlgComDefault></option> <option value='left' lang=DlgAlignLeft></option> <option value='right' lang=DlgAlignRight></option> <option value='top' lang=DlgAlignTop></option> <option value='middle' lang=DlgAlignMiddle></option> <option value='bottom' lang=DlgAlignBottom></option> <option value='absmiddle' lang=DlgAlignAbsmiddle></option> <option value='absbottom' lang=DlgAlignAbsbottom></option> <option value='baseline' lang=DlgAlignBaseline></option> <option value='texttop' lang=DlgAlignTexttop></option> </select> </td> </tr> <tr> <td noWrap width="20%"><span lang=DlgImgWidth></span>:</td> <td noWrap width="29%"><input style="width:80px" type=text id=d_width size=10 value=""></td> <td width="2%">&nbsp;</td> <td noWrap width="20%"><span lang=DlgImgHeight></span>:</td> <td noWrap width="29%"><input style="width:80px" type=text id=d_height size=10 value=""></td> </tr> <tr> <td noWrap width="20%"><span lang=DlgImgVSpace></span>:</td> <td noWrap width="29%"><input style="width:80px" type=text id=d_vspace size=10 value="" onkeydown="fE(event);"></td> <td width="2%">&nbsp;</td> <td noWrap width="20%"><span lang=DlgImgHSpace></span>:</td> <td noWrap width="29%"><input style="width:80px" type=text id=d_hspace size=10 value="" onkeydown="fE(event);"></td> </tr> </table> </td></tr> </table> </fieldset> </td> </tr> </table> </td><td id="TD_Right"> <fieldset id="Fieldset_Right"> <legend><span lang=DlgImgPreview></span></legend> <table border=0 cellpadding=0 cellspacing=5 width="200" height="200" valign=top> <tr><td colspan=2 bgcolor=#FFFFFF align=center valign=middle id=tdPreview height="150"> </td></tr> <tr><td id=tdPreviewSize></td><td align=right><input type=button class="dlgbtn" id=btnPreivew onclick="fr()" lang=DlgImgPreview></td></tr> </table> </fieldset> </td></tr> <tr> <td noWrap> <script type="text/javascript">if(wU){document.write("<input type=checkbox id=d_syflag value='1'><label for=d_syflag><span lang=DlgImgSYFlag></span></label>");}</script> </td> <td noWrap align=right><input type=submit class="dlgBtnCommon dlgBtn" value='' id="d_ok" onclick="ok()" lang=DlgBtnOK>&nbsp;&nbsp;<input type=button class="dlgBtnCommon dlgBtn" value='' onclick="parent.bF()" lang=DlgBtnCancel></td> </tr> </table> <div id="tab_mfu" style="display:none"></div> </td></tr></table> <div id=divProcessing style="width:200px;height:30px;position:absolute;left:80px;top:100px;display:none"> <table border=0 cellpadding=0 cellspacing=1 bgcolor="#000000" width="100%" height="100%"><tr><td bgcolor=#3A6EA5><marquee align="middle" behavior="alternate" scrollamount="5"><font color=#FFFFFF><span lang=DlgComUploading></span></font></marquee></td></tr></table> </div> </body> </html>