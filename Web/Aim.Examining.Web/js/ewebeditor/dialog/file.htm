<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN"> <html> <head> <meta http-equiv="Content-Type" content="text/html; charset=gb2312"> <script type="text/javascript" src="dialog.js"></script> <script type="text/javascript">document.write("<link href='../skin/"+config.Skin+"/dialog.css' type='text/css' rel='stylesheet'>");var bA=lang["DlgFile"];document.write("<title>"+bA+"</title>");var dQ=((parseFloat(config.AllowFileSize)>0)?true:false);var xC,yS;function RadioClick(cK){if(cK=="url"){$("d_fromurl").disabled=false;if(config.AllowBrowse=="1"){$("d_browse").disabled=false;}$("d_checkfromurl").checked=true;if(dQ){$("d_checkfromfile").checked=false;$("uploadfile").disabled=true;}}else{$("d_checkfromurl").checked=false;$("uploadfile").disabled=false;$("d_checkfromfile").checked=true;$("d_fromurl").disabled=true;if(config.AllowBrowse=="1"){$("d_browse").disabled=true;}}};function UploadError(ap){gV();RadioClick('file');$("divProcessing").style.display="none";try{dz($("uploadfile"),jT(ap,config.AllowFileExt,config.AllowFileSize));}catch(e){}};function UploadSaved(ps){$("d_fromurl").value=ps;dC();};function dC(){var url=$("d_fromurl").value;var zJ=iq(url);var xS=gn("sysimage/icon16/"+zJ);EWIN.insertHTML("<img border=0 src='"+xS+"'><a href='"+url+"' target=_blank>"+$("d_filename").value+"</a>");parent.ax();};function ok(){if($("d_checkfromurl").checked){mg($("d_fromurl").value,"/");dC();}else{if(!iW($("uploadfile").value,config.AllowFileExt)){UploadError("ext");return false;}mg($("uploadfile").value,"\\");gW();$("divProcessing").style.display="";document.myuploadform.submit();}};function gW(){$("d_checkfromfile").disabled=true;$("d_checkfromurl").disabled=true;$("d_fromurl").disabled=true;if(config.AllowBrowse=="1"){$("d_browse").disabled=true;}$("d_ok").disabled=true;};function gV(){$("d_checkfromfile").disabled=false;$("d_checkfromurl").disabled=false;$("d_fromurl").disabled=false;if(config.AllowBrowse=="1"){$("d_browse").disabled=false;}$("d_ok").disabled=false;};function iq(url){var iV;iV=url.substr(url.lastIndexOf(".")+1);iV=iV.toUpperCase();var bp;switch(iV){case "TXT":bp="txt.gif";break;case "CHM":case "HLP":bp="hlp.gif";break;case "DOC":case "DOCX":bp="doc.gif";break;case "PDF":bp="pdf.gif";break;case "MDB":bp="mdb.gif";break;case "GIF":bp="gif.gif";break;case "JPG":bp="jpg.gif";break;case "BMP":bp="bmp.gif";break;case "PNG":bp="png.gif";break;case "ASP":case "JSP":case "JS":case "PHP":case "PHP3":case "ASPX":bp="code.gif";break;case "HTM":case "HTML":case "SHTML":bp="htm.gif";break;case "ZIP":bp="zip.gif";break;case "RAR":bp="rar.gif";break;case "EXE":bp="exe.gif";break;case "AVI":bp="avi.gif";break;case "MPG":case "MPEG":case "ASF":bp="mp.gif";break;case "RA":case "RM":bp="rm.gif";break;case "MP3":bp="mp3.gif";break;case "MID":case "MIDI":bp="mid.gif";break;case "WAV":bp="audio.gif";break;case "XLS":bp="xls.gif";break;case "PPT":case "PPS":bp="ppt.gif";break;case "SWF":bp="swf.gif";break;default:bp="unknow.gif";break;}return bp;};function mg(url,nf){$("d_filename").value=url.substr(url.lastIndexOf(nf)+1);};function bm(){lang.aN(document);if(!dQ){RadioClick("url");}else{RadioClick("file");}xC=$("tab_normal").offsetWidth;yS=$("tab_normal").offsetHeight;parent.aR(bA);};function lK(cG,iH,dk){if(dk=="tab_mfu"){DLGMFU.Load("file",$(dk),"500px","250px");}if(DLGTab.hg[cG]){parent.qi(DLGTab.hg[cG].Width,DLGTab.hg[cG].Height);}else{parent.qi();}}</script> <script event="OnCancel(ap)" for="eWebEditorMFU">
if(ap==""){parent.bF();}</script> <script event="OnUpload(ap, ah)" for="eWebEditorMFU">if(ap=="endall"||ap=="endapart"){var K="";var ei=ah.split("|");for(var i=0;i<ei.length;i++){var a=ei[i].split("::");if(a.length==3&&a[1]!=""){var cf=a[0].substr(a[0].lastIndexOf("\\")+1);var gZ=a[1];var oG=iq(gZ);oG=gn('sysimage/icon16/'+oG);K+='<img border=0 src="'+oG+'"><a href="'+gZ+'" target="_blank">'+cf+'</a><br>';EWIN.addUploadFile(cf,gZ);}}EWIN.insertHTML(K);parent.ax();}</script> </head> <body onload="bm()"> <table border=0 cellpadding=0 cellspacing=5 id=tabDialogSize><tr><td> <script type="text/javascript">if(config.MFUEnable=="1"){DLGTab.kh([[lang["DlgComTabNormal"],"tab_normal"],[lang["DlgComTabMFU"],"tab_mfu"]]);}</script> <table id="tab_normal" border=0 cellpadding=0 cellspacing=0 align=center> <tr> <td> <fieldset> <legend><span lang=DlgFileSource></span></legend> <table border=0 cellpadding=5 cellspacing=0 width="100%"> <tr><td> <table border=0 cellpadding=0 cellspacing=0 width="300px"><tr><td></td></tr></table> <table border=0 cellpadding=0 cellspacing=2 width="100%"> <script type="text/javascript">
if(dQ){document.write("<tr>");document.write("<td noWrap width=\"20%\"><input type=radio id=\"d_checkfromfile\" value=\"1\" onclick=\"RadioClick('file')\"><label for=d_checkfromfile>"+lang["DlgFromFile"]+"</label>:</td>");document.write("<td noWrap width=\"80%\">");document.write(nr("file"));document.write("</td>");document.write("</tr>");}</script> <tr> <td noWrap width="20%"><input type=radio id="d_checkfromurl" value="1" onclick="RadioClick('url')"><label for=d_checkfromurl><span lang=DlgFromUrl></span></label>:</td> <td noWrap width="80%"> <script type="text/javascript">if(config.AllowBrowse=="1"){document.write("<table border=0 cellpadding=0 cellspacing=0 width='100%'><tr><td width='100%'><input type=text id='d_fromurl' style='width:100%' size=20 value='http://'></td><td><input class='dlgBtnBrowse' type=button id='d_browse' onclick=\"jO('file','fromurl')\"  value='"+lang["DlgBtnBrowse"]+"' align=absmiddle></td></tr></table>");}else{document.write("<input type=text id='d_fromurl' style='width:100%' size=40 value='http://'>");}</script> </td> </tr> </table> </td></tr> </table> </fieldset> </td> </tr> <tr><td height=5></td></tr> <tr><td noWrap align=right><input type=submit class="dlgBtnCommon dlgBtn" value='' id=d_ok onclick="ok()" lang=DlgBtnOK>&nbsp;&nbsp;<input type=button class="dlgBtnCommon dlgBtn" value='' onclick="parent.bF()" lang=DlgBtnCancel></td></tr> </table> <div id="tab_mfu" style="display:none"></div> </td></tr></table> <div id=divProcessing style="width:200px;height:30px;position:absolute;left:70px;top:30px;display:none"> <table border=0 cellpadding=0 cellspacing=1 bgcolor="#000000" width="100%" height="100%"><tr><td bgcolor=#3A6EA5><marquee align="middle" behavior="alternate" scrollamount="5"><font color=#FFFFFF><span lang=DlgComUploading></span></font></marquee></td></tr></table> </div> <input type=hidden id=d_filename value=""> </body> </html> 