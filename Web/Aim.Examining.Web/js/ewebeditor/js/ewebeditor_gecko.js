/*
*######################################
* eWebEditor v7.3 - Advanced online web based WYSIWYG HTML editor.
* Copyright (c) 2003-2011 eWebSoft.com
*
* For further information go to http://www.ewebeditor.net/
* This copyright notice MUST stay intact for use.
*######################################
*/

String.prototype.gL = function(s) { return (this.indexOf(s) > -1); }; String.prototype.yN = function(s) { return (this.substr(0, s.length) == s); }; String.prototype.fc = function(s, ignoreCase) { var nk = this.length; var il = s.length; if (il > nk) { return false; } if (ignoreCase) { var qJ = new RegExp(s + '$', 'i'); return qJ.test(this); } else { return (il == 0 || this.substr(nk - il, il) == s); } }; String.prototype.pd = function() { return this.replace(/(^[ \t\n\r]*)|([ \t\n\r]*$)/g, ''); }; Array.prototype.eD = function(s) { for (var i = 0; i < this.length; i++) { if (this[i] == s) { return i; } } return -1; }; (function() { var sv = /()??/.exec("")[1] === undefined; var pe = function() { var x = /^/g; x.test(""); return !x.lastIndex; } (); var fu = { exec: RegExp.prototype.exec, match: String.prototype.match, replace: String.prototype.replace, split: String.prototype.split, test: RegExp.prototype.test }; var rr = function(array, item, from) { for (var i = from || 0; i < array.length; i++) { if (array[i] === item) { return i; } } return -1; }; var sQ = function(dg) { return (dg.global ? "g" : "") + (dg.ignoreCase ? "i" : "") + (dg.multiline ? "m" : "") + (dg.extended ? "x" : "") + (dg.sticky ? "y" : ""); }; var nU = function(o) { return Object.prototype.toString.call(o) === "[object RegExp]"; }; RegExp.prototype.exec = function(av) { var match = fu.exec.apply(this, arguments), name, r2; if (match) { if (!sv && match.length > 1 && rr(match, "") > -1) { r2 = RegExp("^" + this.source + "$(?!\\s)", sQ(this)); fu.replace.call(match[0], r2, function() { for (var i = 1; i < arguments.length - 2; i++) { if (arguments[i] === undefined) { match[i] = undefined; } } }); } if (!pe && this.global && this.lastIndex > (match.index + match[0].length)) { this.lastIndex--; } } return match; }; if (!pe) { RegExp.prototype.test = function(av) { var match = fu.exec.call(this, av); if (match && this.global && this.lastIndex > (match.index + match[0].length)) { this.lastIndex--; } return !!match; }; } String.prototype.match = function(dg) { if (!nU(dg)) { dg = RegExp(dg); } if (dg.global) { var result = fu.match.apply(this, arguments); dg.lastIndex = 0; return result; } return dg.exec(this); }; String.prototype.split = function(s, dn) { if (!nU(s)) { return fu.split.apply(this, arguments); } var av = this + "", output = [], hc = 0, match, lW; if (dn === undefined || +dn < 0) { dn = Infinity; } else { dn = Math.floor(+dn); if (!dn) { return []; } } while (match = s.exec(av)) { if (s.lastIndex > hc) { output.push(av.slice(hc, match.index)); if (match.length > 1 && match.index < av.length) { Array.prototype.push.apply(output, match.slice(1)); } lW = match[0].length; hc = s.lastIndex; if (output.length >= dn) { break; } } if (!match[0].length) { s.lastIndex++; } } if (hc === av.length) { if (!fu.test.call(s, "") || lW) { output.push(""); } } else { output.push(av.slice(hc)); } return output.length > dn ? output.slice(0, dn) : output; }; })(); var az = (function() { var cj = new Object(); var hM = document.location.search.substr(1).split("&"); for (i = 0; i < hM.length; i++) { var jh = hM[i].split("="); cj[jh[0]] = jh[1]; } var dO = function(ag, qM) { return (cj[ag]) ? cj[ag] : qM; }; return { ad: dO("id", ""), rF: dO("originalfilename", ""), sd: dO("savefilename", ""), sp: dO("savepathfilename", ""), ExtCSS: dO("extcss", ""), FullScreen: dO("fullscreen", ""), StyleName: dO("style", "coolblue"), CusDir: dO("cusdir", ""), Skin: dO("skin", ""), FixWidth: dO("fixwidth", ""), Lang: dO("lang", ""), AreaCssMode: dO("areacssmode", ""), ReadOnly: dO("readonly", ""), SKey: dO("skey", "") }; })(); var t = (function() { var s = navigator.userAgent.toLowerCase(); var oD = (/*@cc_on!@*/false); var gP = 0; if (oD) { gP = parseInt(s.match(/msie (\d+)/)[1], 10); } return { bu: oD, wl: (gP == 6), wt: (gP >= 6), gd: (gP >= 7), vy: (gP >= 8), jW: s.gL('gecko/'), iT: s.gL('safari'), kU: !!window.opera, xj: s.gL(' adobeair/'), vq: s.gL('macintosh'), wq: s.gL('chrome/'), kf: true }; })(); var lang = new Object(); lang.aN = function(eU) { var gr = eU.getElementsByTagName("INPUT"); for (i = 0; i < gr.length; i++) { if (gr[i].getAttribute("lang")) { gr[i].value = lang[gr[i].getAttribute("lang")]; } } var ga = eU.getElementsByTagName("SPAN"); for (i = 0; i < ga.length; i++) { if (ga[i].getAttribute("lang")) { ga[i].innerHTML = lang[ga[i].getAttribute("lang")]; } } var fO = eU.getElementsByTagName("OPTION"); for (i = 0; i < fO.length; i++) { if (fO[i].getAttribute("lang")) { fO[i].innerHTML = lang[fO[i].getAttribute("lang")]; } } }; var EWEBMenu = (function() { var tU = 9999; var bI, dr, aS; var kq, aO, kI, ki; var aC = { x: 0, y: 0, cZ: 0, rel: null }; var ru; var ea; var eQ = false; var cS; var nP = function() { if (bI) { return; } kI = "<table border=0 cellpadding=0 cellspacing=0 class='Menu_Box' id=Menu_Box><tr><td class='Menu_Box'><table border=0 cellpadding=0 cellspacing=0 class='Menu_Table'>"; aO = "<tr><td class='Menu_Sep'><table border=0 cellpadding=0 cellspacing=0 class='Menu_Sep'><tr><td></td></tr></table></td></tr>"; ki = "</table></td></tr></table>"; kq = "<html><head>" + "<link href='" + O.cd + "/skin/" + config.Skin + "/menuarea.css' type='text/css' rel='stylesheet'>" + "</head>" + "<body scroll='no'>"; if (t.bu) { dr = window.createPopup(); bI = dr.document; bI.open(); bI.write(kq); bI.close(); } else { cS = H.og(); var mB = cS.document; aS = mB.createElement('iframe'); H.fS(aS); aS.src = 'javascript:void(0)'; aS.allowTransparency = true; aS.frameBorder = '0'; aS.scrolling = 'no'; aS.style.width = aS.style.height = '0px'; H.dB(aS, { position: 'absolute', zIndex: tU }); aS.jt = window; mB.body.appendChild(aS); var jP = aS.contentWindow; bI = jP.document; bI.open(); bI.write(kq); bI.close(); ru = H.eN(bI); H.iy(bI.body); H.bM(jP, 'focus', sL); H.bM(jP, 'blur', qR); } ea = bI.body.appendChild(bI.createElement('DIV')); ea.style.cssFloat = 'left'; H.bM(bI, 'contextmenu', H.as); H.bM(bI, 'dragstart', H.as); H.bM(bI, 'selectstart', H.as); H.bM(bI, 'select', H.as); }; var dG = function(bn, mt, gK, K) { var eg = ""; var jE; if (t.bu) { jE = "var w=parent;w." + mt + ";w.EWEBMenu.Hide();"; } else { jE = "var w=frameElement.jt;w." + mt + ";w.EWEBMenu.Hide();" } if (bn == "") { eg += "<tr><td class='Menu_Item'><table border=0 cellpadding=0 cellspacing=0 width='100%'><tr><td valign=middle class=MouseOut onMouseOver=\"this.className='MouseOver'\" onMouseOut=\"this.className='MouseOut'\" onclick=\"" + jE + "\">"; } else { eg += "<tr><td class='Menu_Item'><table border=0 cellpadding=0 cellspacing=0 width='100%'><tr><td valign=middle class=MouseDisabled>"; } bn = (bn) ? "_Disabled" : ""; eg += "<table border=0 cellpadding=0 cellspacing=0><tr><td class=Menu_Image_TD>"; if (typeof (gK) == "number") { var dP = "skin/" + config.Skin + "/buttons.gif"; var cu = 16 - gK * 16; eg += "<div class='Menu_Image" + bn + "'><img src='" + dP + "' style='top:" + cu + "px'></div>"; } else if (gK != "") { var dP = "skin/" + config.Skin + "/" + gK; eg += "<img class='Menu_Image" + bn + "' src='" + dP + "'>"; } eg += "</td><td class='Menu_Label" + bn + "'>" + K + "</td></tr></table>"; eg += "</td></tr></table></td><\/tr>"; return eg; }; var G = function(bn, ac, ff) { var ck = Buttons[ac]; if (!ff) { ff = lang[ac]; } else { ff = lang[ff]; } return dG(bn, ck[1], ck[0], ff); }; var bb = function(ac, bJ) { var bn = ""; if (!bJ) { bJ = ac; } try { if (!O.J.queryCommandEnabled(bJ)) { bn = "disabled"; } } catch (e) { } return G(bn, ac); }; var et = function(cK) { var T = ""; var bn = "disabled"; switch (cK) { case "TableInsert": if (!EWEBTable.hX()) { bn = ""; } T += G(bn, "TableInsert"); break; case "TableProp": if (EWEBTable.hX() || EWEBTable.ba()) { bn = ""; } T += G(bn, "TableProp"); break; case "TableCell": if (EWEBTable.ba()) { bn = ""; } T += G(bn, "TableCellProp"); T += G(bn, "TableCellSplit"); T += aO; T += G(bn, "TableRowProp"); T += G(bn, "TableRowInsertAbove"); T += G(bn, "TableRowInsertBelow"); T += G(bn, "TableRowMerge"); T += G(bn, "TableRowSplit"); T += G(bn, "TableRowDelete"); T += aO; T += G(bn, "TableColInsertLeft"); T += G(bn, "TableColInsertRight"); T += G(bn, "TableColMerge"); T += G(bn, "TableColSplit"); T += G(bn, "TableColDelete"); break; } return T; }; var rZ = function() { if (V.bC() == "Control") { return ""; } var v = ""; if (t.bu) { var aM = O.J.selection.createRange(); var dp = O.J.body.createTextRange(); var R = aM.parentElement(); v = R.currentStyle.fontSize; var bz = R.childNodes; for (var i = 0; i < bz.length; i++) { if (bz[i].nodeType == 1) { dp.moveToElementText(bz[i]); if (((aM.compareEndPoints("StartToEnd", dp) < 0) && (aM.compareEndPoints("StartToStart", dp) > 0)) || ((aM.compareEndPoints("EndToStart", dp) > 0) && (aM.compareEndPoints("EndToEnd", dp) < 0))) { if (bz[i].currentStyle.fontSize != v) { v = ""; break; } } } } } else { var dW = V.cX(); if (!dW) { return ""; } var cU = V.bd().getRangeAt(0); var ek = O.J.createRange(); r = H.aU(dW, "font-size"); var bz = dW.getElementsByTagName("*"); for (var i = 0; i < bz.length; i++) { var R = bz[i]; ek.selectNodeContents(R); if ((ek.compareBoundaryPoints(Range.START_TO_END, cU) >= 0) && (ek.compareBoundaryPoints(Range.END_TO_START, cU) <= 0)) { var v = H.aU(R, "font-size"); if (r != v) { r = ""; break; } } } } return v; }; var nK = function(ae, cl, hx) { if (V.bC() == "Control") { if (ae) { var R = V.aW(); if (R.tagName.toUpperCase() == ae) { if ((cl) && (hx)) { if (R.getAttribute(cl, 2).toLowerCase() == hx.toLowerCase()) { return true; } } else { return true; } } } else { return true; } } return false; }; rM = function() { if (bI.readyState != "complete") { return false; } if (bI.images) { for (var i = 0; i < bI.images.length; i++) { var img = bI.images[i]; if (!img.complete) { return false; } } } return true; }; return { Show: function() { if (t.bu) { if (!rM()) { window.setTimeout("EWEBMenu.Show()", 50); return; } var w = bI.body.scrollWidth; var h = bI.body.scrollHeight; if (aC.x + w > document.body.clientWidth) { aC.x = aC.x - w + aC.cZ; } dr.show(aC.x, aC.y, w, h, aC.rel); } else { var w = ea.offsetWidth; var h = ea.offsetHeight; var x = aC.x; var y = aC.y; if (bI.readyState != "complete") { window.setTimeout("EWEBMenu.Show()", 50); return; } H.dB(aS, { width: w + 'px', height: h + 'px', left: x + 'px', top: y + 'px' }); eQ = true; } }, ShowToolMenu: function(e, ap) { if (O.aj != "EDIT") { return H.as(e); } nP(); if (eQ) { this.Hide(); } var T = ""; switch (ap) { case "font": T += bb("Bold"); T += bb("Italic"); T += bb("UnderLine"); T += bb("StrikeThrough"); T += aO; T += bb("SuperScript"); T += bb("SubScript"); T += aO; T += G("", "UpperCase"); T += G("", "LowerCase"); T += aO; T += G("", "ForeColor"); T += G("", "BackColor"); T += aO; T += G("", "Big"); T += G("", "Small"); break; case "paragraph": T += bb("JustifyLeft"); T += bb("JustifyCenter"); T += bb("JustifyRight"); T += bb("JustifyFull"); T += aO; T += bb("OrderedList", "insertorderedlist"); T += bb("UnOrderedList", "insertunorderedlist"); T += bb("Indent"); T += bb("Outdent"); T += aO; T += bb("Paragraph", "insertparagraph"); T += G("", "BR"); T += aO; T += G((kN()) ? "" : "disabled", "ParagraphAttr", "CMenuParagraph"); break; case "edit": var bn = ""; if (!EWEBHistory.qU()) { bn = "disabled"; } T += G(bn, "UnDo"); if (!EWEBHistory.pW()) { bn = "disabled"; } T += G(bn, "ReDo"); T += aO; T += bb("Cut"); T += bb("Copy"); T += G("", "Paste"); T += G("", "PasteText"); T += G("", "PasteWord"); T += aO; T += bb("Delete"); T += bb("RemoveFormat"); T += aO; T += bb("SelectAll"); T += bb("UnSelect"); T += aO; T += G("", "FindReplace"); T += G("", "QuickFormat"); break; case "object": T += G("", "BgColor"); T += G("", "BackImage"); T += aO; T += G("", "absolutePosition"); T += G("", "zIndexForward"); T += G("", "zIndexBackward"); T += aO; T += G("", "ShowBorders"); T += aO; T += G("", "Quote"); T += G("", "Code"); break; case "component": T += G("", "Image"); T += G("", "Flash"); T += G("", "Media"); T += G("", "File"); T += aO; T += G("", "RemoteUpload"); T += G("", "LocalUpload"); T += aO; T += G("", "Fieldset"); T += G("", "Iframe"); T += bb("HorizontalRule", "InsertHorizontalRule"); T += G("", "Marquee"); T += aO; T += G("", "CreateLink"); T += G("", "Anchor"); T += G("", "Map"); T += bb("Unlink"); break; case "tool": T += G("", "Template"); T += G("", "Symbol"); T += G("", "Excel"); T += G("", "Emot"); T += aO; T += G("", "EQ"); T += G("", "Art"); T += aO; T += G("", "NowDate"); T += G("", "NowTime"); T += aO; T += G("", "ImportWord"); T += G("", "ImportExcel"); T += G("", "Capture"); T += aO; T += G("", "Pagination"); T += G("", "PaginationInsert"); break; case "file": T += G("", "Refresh"); T += aO; T += G("", "ModeCode"); T += G("", "ModeEdit"); T += G("", "ModeText"); T += G("", "ModeView"); T += aO; T += G("", "SizePlus"); T += G("", "SizeMinus"); T += aO; T += G("", "Print"); T += aO; T += G("", "About"); T += G("", "Site"); height = 208; break; case "table": T += et("TableInsert"); T += et("TableProp"); T += aO; T += et("TableCell"); break; case "form": T += bb("FormText", "InsertInputText"); T += bb("FormTextArea", "InsertTextArea"); T += bb("FormRadio", "InsertInputRadio"); T += bb("FormCheckbox", "InsertInputCheckbox"); T += bb("FormDropdown", "InsertSelectDropdown"); T += bb("FormButton", "InsertButton"); break; case "gallery": T += G("", "GalleryImage"); T += G("", "GalleryFlash"); T += G("", "GalleryMedia"); T += G("", "GalleryFile"); break; case "zoom": for (var i = 0; i < EWEBCommandZoom.Options.length; i++) { if (EWEBCommandZoom.Options[i] == EWEBCommandZoom.oT) { T += dG("", "EWEBCommandZoom.Execute(" + EWEBCommandZoom.Options[i] + ")", 120, EWEBCommandZoom.Options[i] + "%"); } else { T += dG("", "EWEBCommandZoom.Execute(" + EWEBCommandZoom.Options[i] + ")", 119, EWEBCommandZoom.Options[i] + "%"); } } break; case "fontsize": var v = rZ(); for (var i = 0; i < lang["FontSizeItem"].length; i++) { if (lang["FontSizeItem"][i][0] == v) { T += dG("", "fk('size','" + lang["FontSizeItem"][i][0] + "')", 120, lang["FontSizeItem"][i][1]); } else { T += dG("", "fk('size','" + lang["FontSizeItem"][i][0] + "')", 119, lang["FontSizeItem"][i][1]); } } break; case "fontname": var v = O.J.queryCommandValue("FontName"); for (var i = 0; i < lang["FontNameItem"].length; i++) { if (lang["FontNameItem"][i] == v) { T += dG("", "fk('face','" + lang["FontNameItem"][i] + "')", 120, lang["FontNameItem"][i]); } else { T += dG("", "fk('face','" + lang["FontNameItem"][i] + "')", 119, lang["FontNameItem"][i]); } } break; case "formatblock": var v = O.J.queryCommandValue("FormatBlock"); if (v) { v = v.toLowerCase(); } else { v = ""; } for (var i = 0; i < lang["FormatBlockItem"].length; i++) { if (lang["FormatBlockItem"][i][0].toLowerCase() == v) { T += dG("", "format('FormatBlock','" + lang["FormatBlockItem"][i][0] + "')", 120, lang["FormatBlockItem"][i][1]); } else { T += dG("", "format('FormatBlock','" + lang["FormatBlockItem"][i][0] + "')", 119, lang["FormatBlockItem"][i][1]); } } break; } ea.innerHTML = kI + T + ki; if (dr) { dr.show(0, 0, 0, 0, document.body); e = window.event; e.returnValue = false; var R = e.srcElement; var x = e.clientX - e.offsetX; var y = e.clientY - e.offsetY; if (R.style.top) { y = y - parseInt(R.style.top); } if (R.tagName.toLowerCase() == "img") { R = R.parentNode; x = x - R.offsetLeft - R.clientLeft; y = y - R.offsetTop - R.clientTop; } if (R.className == "TB_Btn_Image") { R = R.parentNode; x = x - R.offsetLeft - R.clientLeft; y = y - R.offsetTop - R.clientTop; } y = y + R.offsetHeight; var cZ = parseInt(R.offsetWidth); aC.x = x; aC.y = y; aC.cZ = cZ; aC.rel = document.body; EWEBMenu.Show(); } else { var R = e.target; if (R.tagName.toLowerCase() == "img" || R.className == "TB_Btn_Image") { R = R.parentNode; } var x = 0; var y = 0; var cZ = R.offsetWidth; var hy = R; if (t.iT) { x = e.clientX; y = e.clientY; } else { x = e.pageX; y = e.pageY; } var ej = H.jc(cS, R); x = ej.x; y = ej.y + R.offsetHeight; aC.x = x; aC.y = y; aC.cZ = cZ; aS.contentWindow.focus(); window.setTimeout("EWEBMenu.Show()", 1); } }, uv: function(e) { if (O.aj != "EDIT") { return H.as(e); } nP(); if (eQ) { EWEBMenu.Hide(); } var T = ""; T += bb("Cut"); T += bb("Copy"); T += G("", "Paste"); T += bb("Delete"); T += bb("SelectAll"); T += aO; if (EWEBTable.ba()) { T += et("TableProp"); T += et("TableCell"); T += aO; } if (nK("TABLE")) { T += et("TableProp"); T += aO; } if (nK("IMG")) { var cT = bo.tN(); if (!cT) { T += G("", "Image", "CMenuImg"); T += aO; T += G("", "zIndexForward"); T += G("", "zIndexBackward"); T += aO; } if (cT == "flash") { T += G("", "Flash", "CMenuFlash"); T += aO; } if (cT == "mediaplayer6" || cT == "mediaplayer7" || cT == "realplayer" || cT == "quicktime" || cT == "flv") { T += G("", "Media", "CMenuMedia"); T += aO; } } if (kN()) { T += G("", "ParagraphAttr", "CMenuParagraph"); T += aO; } T += G("", "FindReplace"); ea.innerHTML = kI + T + ki; if (dr) { dr.show(0, 0, 0, 0, document.body); e = eWebEditor.event; aC.x = e.clientX; aC.y = e.clientY; aC.cZ = 0; aC.rel = O.J.body; EWEBMenu.Show(); } else { H.as(e); aC.x = e.pageX; aC.y = e.pageY; var R = O.J; var ej = H.jc(cS, (H.eN(R) ? R.documentElement : R.body)); aC.x += ej.x; aC.y += ej.y; aC.cZ = 0; aS.contentWindow.focus(); window.setTimeout("EWEBMenu.Show()", 1); } return false; }, Hide: function() { if (dr) { dr.hide(); } else { if (!eQ) { return; } aS.style.width = aS.style.height = '0px'; eQ = false; } } }; })(); function sL(e) { }; function qR(e) { EWEBMenu.Hide(); }; var dm = (function() { var ez; var vh = 9999; var dN; var eR; var cS; var di; var hU = function() { return ++vh; }; var nG = function() { if (!dN) { return; } var hy = H.eN(di) ? di.documentElement : di.body; H.dB(dN, { 'width': Math.max(hy.scrollWidth, hy.clientWidth, di.scrollWidth || 0) - 1 + 'px', 'height': Math.max(hy.scrollHeight, hy.clientHeight, di.scrollHeight || 0) - 1 + 'px' }); }; var po = function(R) { H.dB(R, { 'zIndex': hU() }); }; var rU = function() { if (!cS) { cS = H.og(); di = cS.document; } dN = di.createElement("div"); H.fS(dN); H.dB(dN, { "position": "absolute", "zIndex": hU(), "top": "0px", "left": "0px", "backgroundColor": "#ffffff" }); H.tu(dN, 0.50); if (t.bu && !t.gd) { eR = di.createElement("iframe"); H.fS(eR); eR.hideFocus = true; eR.frameBorder = 0; eR.src = H.ib(); H.dB(eR, { "width": "100%", "height": "100%", "position": "absolute", "left": "0px", "top": "0px", "filter": "progid:DXImageTransform.Microsoft.Alpha(opacity=0)" }); dN.appendChild(eR); } H.bM(cS, "resize", nG); nG(); di.body.appendChild(dN); }; var rw = function() { H.dh(dN); }; return { OpenDialog: function(sD) { if (!ez) { rU(); } else { po(dN); } var sZ = { uq: cS, aG: window, Page: sD }; V.Save(true); var dV = 160; var ct = 100; var dialog = di.createElement('iframe'); H.fS(dialog); dialog.frameBorder = 0; dialog.allowTransparency = true; var sX = t.bu && (!t.gd || !H.eN(cS.document)); H.dB(dialog, { 'position': (sX) ? 'absolute' : 'fixed', 'width': dV + 'px', 'height': ct + 'px', 'zIndex': hU() }); this.oA(dialog, dV, ct); dialog.src = O.cd + "/dialog/dialog.htm"; dialog.jt = sZ; di.body.appendChild(dialog); dialog.ld = ez; ez = dialog; }, tO: function(rD) { var dialog = rD.frameElement; H.dh(dialog); if (dialog.ld) { ez = dialog.ld; po(ez); } else { rw(); setTimeout(function() { ez = null; }, 0); V.pG(); } }, oA: function(dialog, dV, ct) { if (!dV) { dV = parseInt(dialog.style.width, 10); } if (!ct) { ct = parseInt(dialog.style.height, 10); } var nN = H.gN(cS); var kn = { 'X': 0, 'Y': 0 }; var rA = t.bu && (!t.gd || !H.eN(cS.document)); if (rA) { kn = H.gT(cS); } var cu = Math.max(kn.Y + (nN.Height - ct - 20) / 2, 0); var hT = Math.max(kn.X + (nN.Width - dV - 20) / 2, 0); H.dB(dialog, { 'top': cu + 'px', 'left': hT + 'px' }); }, wE: function() { return dN; }, yD: function() { return ez; } }; })(); var dK = (function() { var sO = function(eL) { eL.onmouseover = tg; eL.onmouseout = ta; eL.onmousedown = tX; eL.onmouseup = si; eL.ondragstart = H.as; eL.onselectstart = H.as; eL.onselect = H.as; eL.rq = true; return true; }; var gS = function(e) { if (!e) { e = window.event; } var R = e.srcElement || e.target; if (R.tagName == "IMG") { R = R.parentNode; } if (R.className == "TB_Btn_Image") { R = R.parentNode; } return R; }; var tg = function(e) { var R = gS(e); R.className = "TB_Btn_Over"; }; var ta = function(e) { var R = gS(e); if (R.cN) { R.className = "TB_Btn_Down"; } else { R.className = "TB_Btn"; } }; var tX = function(e) { var R = gS(e); R.className = "TB_Btn_Down"; }; var si = function(e) { var R = gS(e); if (R.className = "TB_Btn_Down") { R.className = "TB_Btn_Over"; } else { if (R.cN) { R.className = "TB_Btn_Down"; } else { R.className = "TB_Btn"; } } }; var eh; var lw = function() { if (eh) { return; } var oR = { normal: ["Bold", "Italic", "UnderLine", "StrikeThrough", "SuperScript", "SubScript", "JustifyLeft", "JustifyCenter", "JustifyRight", "JustifyFull"], mode: ["ModeCode", "ModeEdit", "ModeView", "ModeText"], other: ["ShowBlocks", "ShowBorders", "Maximize"] }; var bz = $("eWebEditor_Toolbar").getElementsByTagName("DIV"); eh = new Object; for (io in oR) { var oY = oR[io]; var jr = new Object; for (var i = 0; i < oY.length; i++) { var bJ = oY[i]; jr[bJ] = new Array(); for (var j = 0; j < bz.length; j++) { var R = bz[j]; if (R.getAttribute("name") == "TB_Name_" + bJ) { jr[bJ][jr[bJ].length] = R; } } } eh[io] = jr; } }; var rv = function(gx) { lw(); var hJ = eh["normal"]; for (bJ in hJ) { var v = O.J.queryCommandState(bJ); var bz = hJ[bJ]; for (var j = 0; j < bz.length; j++) { var R = bz[j]; R.cN = v; if (gx) { R.className = "TB_Btn"; } else { if (v) { R.className = "TB_Btn_Down"; } else { R.className = "TB_Btn"; } } } } }; var sn = function() { lw(); var hJ = eh["mode"]; for (bJ in hJ) { var bz = hJ[bJ]; for (var j = 0; j < bz.length; j++) { var R = bz[j]; var aQ = R.getAttribute("name"); aQ = aQ.substr(aQ.length - 4).toUpperCase(); if (aQ == O.aj) { R.cN = "on"; R.className = "TB_Btn_Down"; } else { R.cN = ""; R.className = "TB_Btn"; } } } }; var rH = function(gx) { var de, v; de = "FontName"; if (gx) { v = ""; } else { v = O.J.queryCommandValue(de); } ph(de, v); de = "FontSize"; if (gx) { v = ""; } else { v = O.J.queryCommandValue(de); if (v) { v = mn(v); } else { v = sz(); } } ph(de, v); }; var ph = function(de, v) { var bz = document.getElementsByName("TB_Name_" + de); for (var i = 0; i < bz.length; i++) { var R = bz[i]; if (v) { v = v.toLowerCase(); v = v.replace(/[\'\"]/gi, ''); var b = false; for (var j = 0; j < R.options.length; j++) { var pg = R.options[j].value.toLowerCase(); if (pg == v || (de == "FontSize" && sM(pg, v))) { R.selectedIndex = j; b = true; break; } } if (!b) { R.options[R.options.length] = new Option(v, v); R.selectedIndex = R.options.length - 1; } } else { R.selectedIndex = 0; } } }; var sM = function(bU, bN) { bU = bU.toLowerCase(); bN = bN.toLowerCase(); if (bU == bN) { return true; } if (bU.fc("pt") && bN.fc("px")) { var ix = 0; bU = parseFloat(bU) + ""; var n = bU.indexOf("."); if (n >= 0) { var s = bU.substr(n + 1); ix = s.length; } if (ix > 0) { if (bU == Math.round(parseFloat(bN) * 3 / 4 * Math.pow(10, ix) + 0.01) / Math.pow(10, ix)) { return true; } } else { if (bU == parseInt(parseFloat(bN) * 3 / 4 + 0.01)) { return true; } } } return false; }; var sz = function() { var r = ""; if (t.bu) { var aX = V.bd().createRange(); if (aX.text.length <= 1) { return aX.parentElement().currentStyle.fontSize; } var html = aX.htmlText; html = html.replace(/<[^>]+>/gi, " "); html = html.replace(/(&nbsp\;|\s)+/gi, " "); html = html.replace(/(^\s*)|(\s*$)/gi, ""); var kM = html.split(" "); var pA = aX.getBookmark(); aX.collapse(); for (var i = 0; i < kM.length; i++) { if (!kM[i]) { continue; } var b = aX.findText(kM[i]); if (b) { var v = aX.parentElement().currentStyle.fontSize; if ((r != "") && (r != v)) { r = ""; break; } r = v; aX.collapse(false); } else { break; } } aX.moveToBookmark(pA); } else { var dW = V.cX(); if (!dW) { return ""; } var cU = V.bd().getRangeAt(0); var ek = O.J.createRange(); r = H.aU(dW, "font-size"); var bz = dW.getElementsByTagName("*"); for (var i = 0; i < bz.length; i++) { var R = bz[i]; ek.selectNodeContents(R); if ((ek.compareBoundaryPoints(Range.START_TO_END, cU) >= 0) && (ek.compareBoundaryPoints(Range.END_TO_START, cU) <= 0)) { var v = H.aU(R, "font-size"); if (r != v) { r = ""; break; } } } if (r != "") { } } return r; }; return { sl: function() { var i, bz, R, p; p = $("eWebEditor_Toolbar"); bz = p.getElementsByTagName("div"); for (i = 0; i < bz.length; i++) { R = bz[i]; if (R.className == "TB_Btn") { if (R.rq == null) { if (!sO(R)) { alert("Problem initializing:" + R.id); return false; } } } } return true; }, gp: function() { if (O.aj != "EDIT") { return; } var b = (V.bC() == "Control") ? true : false; rv(b); rH(b); }, rm: function() { sn(); }, iU: function(io, ri) { lw(); return eh[io][ri]; } }; })(); var EWEBTable = (function() { var bO; var an; var nL; var da; return { ba: function() { if (V.bC() != "Control") { var R = V.cX(); while (R) { if (!R.tagName) { R = null; break; } if (R.tagName.toUpperCase() == "TD" || R.tagName.toUpperCase() == "TH") { break; } else if (R.tagName.toUpperCase() == "BODY" || R.tagName.toUpperCase() == "HTML") { R = null; break; } R = R.parentNode; } if (R) { bO = R; an = bO.parentNode; nL = an.parentNode; da = nL.parentNode; return true; } } return false; }, hX: function() { if (V.bC() == "Control") { var R = V.aW(); if (R.tagName.toUpperCase() == "TABLE") { da = R; return true; } } return false; }, TableInsert: function() { if (!EWEBTable.hX()) { af('table.htm', true); } }, TableProp: function() { if (EWEBTable.hX() || EWEBTable.ba()) { af('table.htm?action=modify', true); } }, CellProp: function() { if (EWEBTable.ba()) { af('tablecell.htm', true); } }, CellSplit: function() { if (EWEBTable.ba()) { af('tablecellsplit.htm', true); } }, RowProp: function() { if (EWEBTable.ba()) { af('tablecell.htm?action=row', true); } }, RowInsertAbove: function() { if (!EWEBTable.ba()) { return; } EWEBHistory.Save(); var dI = 0; ci = an.cells; for (var i = 0; i < ci.length; i++) { dI = dI + ci[i].getAttribute('colSpan'); } var gX = da.insertRow(an.rowIndex); for (i = 0; i < dI; i++) { ec = gX.insertCell(-1); ec.innerHTML = "&nbsp;"; } EWEBHistory.Save(); }, RowInsertBelow: function() { if (!EWEBTable.ba()) { return; } EWEBHistory.Save(); var dI = 0; ci = an.cells; for (var i = 0; i < ci.length; i++) { dI = dI + ci[i].getAttribute('colSpan'); } var gX = da.insertRow(an.rowIndex + 1); for (i = 0; i < dI; i++) { ec = gX.insertCell(-1); ec.innerHTML = "&nbsp;"; } EWEBHistory.Save(); }, RowMerge: function() { if (!EWEBTable.ba()) { return; } EWEBHistory.Save(); var yd = bO.getAttribute('rowSpan'); bf = da.rows; if (an.rowIndex + 1 != bf.length) { var rY = bf[an.rowIndex + bO.rowSpan].cells; var jK = rY[bO.cellIndex].getAttribute('rowSpan'); var moveTo = bO.rowSpan; if (!jK) jK = 1; bO.rowSpan = bO.rowSpan + jK; bf[an.rowIndex + moveTo].deleteCell(bO.cellIndex); } EWEBHistory.Save(); }, RowSplit: function(mX) { if (!EWEBTable.ba()) { return; } if (mX < 2) { return; } EWEBHistory.Save(); var sH = mX - 1; var kg = sH; var gj = 0; for (var i = 0; i < bO.cellIndex; i++) { gj += an.cells[i].colSpan; } var bf = da.rows; while (bO.rowSpan > 1 && kg > 0) { var jA = bf[an.rowIndex + bO.rowSpan - 1]; bO.rowSpan -= 1; var fR = 0; var position = -1; for (var n = 0; n < jA.cells.length; n++) { fR += jA.cells[n].getAttribute('colSpan'); if (fR > gj) { position = n; break; } } var ec = jA.insertCell(position); ec.innerHTML = "&nbsp;"; kg -= 1; } for (var n = 0; n < kg; n++) { var dI = 0; ci = an.cells; for (var i = 0; i < ci.length; i++) { dI = dI + ci[i].getAttribute('colSpan'); } var gX = da.insertRow(an.rowIndex + 1); for (var j = 0; j < an.rowIndex; j++) { for (var k = 0; k < bf[j].cells.length; k++) { if ((bf[j].cells[k].rowSpan > 1) && (bf[j].cells[k].rowSpan >= an.rowIndex - bf[j].rowIndex + 1)) { bf[j].cells[k].rowSpan += 1; } } } for (i = 0; i < ci.length; i++) { if (i != bO.cellIndex) { an.cells[i].rowSpan += 1; } else { ec = gX.insertCell(-1); ec.colSpan = bO.colSpan; ec.innerHTML = "&nbsp;"; } } } EWEBHistory.Save(); }, RowDelete: function() { if (!EWEBTable.ba()) { return; } EWEBHistory.Save(); da.deleteRow(an.rowIndex); EWEBHistory.Save(); }, ColInsertLeft: function() { if (!EWEBTable.ba()) { return; } EWEBHistory.Save(); hz = (an.cells.length - 1) - (bO.cellIndex); bf = da.rows; for (i = 0; i < bf.length; i++) { lc = bf[i].cells.length - 1; position = lc - hz; if (position < 0) { position = 0; } cW = bf[i].insertCell(position); cW.innerHTML = "&nbsp;"; } EWEBHistory.Save(); }, ColInsertRight: function() { if (!EWEBTable.ba()) { return; } EWEBHistory.Save(); hz = (an.cells.length - 1) - (bO.cellIndex); bf = da.rows; for (i = 0; i < bf.length; i++) { lc = bf[i].cells.length - 1; position = lc - hz; if (position < 0) { position = 0; } cW = bf[i].insertCell(position + 1); cW.innerHTML = "&nbsp;"; } EWEBHistory.Save(); }, ColMerge: function() { if (!EWEBTable.ba()) { return; } EWEBHistory.Save(); var rW = bO.getAttribute('colSpan'); ci = an.cells; if (bO.cellIndex + 1 != an.cells.length) { var rQ = ci[bO.cellIndex + 1].getAttribute('colSpan'); bO.colSpan = rW + rQ; an.deleteCell(bO.cellIndex + 1); } EWEBHistory.Save(); }, ColDelete: function() { if (!EWEBTable.ba()) { return; } EWEBHistory.Save(); hz = (an.cells.length - 1) - (bO.cellIndex); bf = da.rows; for (var i = 0; i < bf.length; i++) { rJ = bf[i].cells.length - 1; position = rJ - hz; if (position < 0) { position = 0; } jL = bf[i].cells; if (jL[position].colSpan > 1) { jL[position].colSpan = jL[position].colSpan - 1; } else { bf[i].deleteCell(position); } } EWEBHistory.Save(); }, ColSplit: function(mi) { if (!EWEBTable.ba()) { return; } if (mi < 2) { return; } EWEBHistory.Save(); var sN = mi - 1; var gY = sN; var cW; var gj = 0; var hW = 0; for (var i = 0; i < bO.cellIndex; i++) { gj += an.cells[i].colSpan; if (an.cells[i].rowSpan > 1) { hW += 1; } } var bf = da.rows; while (bO.colSpan > 1 && gY > 0) { cW = an.insertCell(bO.cellIndex + 1); cW.innerHTML = "&nbsp;"; bO.colSpan -= 1; gY -= 1; } for (i = 0; i < bf.length; i++) { var fR = 0; var position = -1; for (var n = 0; n < bf[i].cells.length; n++) { fR += bf[i].cells[n].getAttribute('colSpan'); if (fR + hW > gj) { position = n; break; } } if (an.rowIndex != i) { if (position != -1) { bf[i].cells[position + hW].colSpan += gY; } } else { for (var n = 0; n < gY; n++) { cW = bf[i].insertCell(bO.cellIndex + 1); cW.innerHTML = "&nbsp;"; cW.rowSpan = bO.rowSpan; } } } EWEBHistory.Save(); } }; })(); var EWEBTableResize = (function() { var mT = 2; var mo = 5; var bY = false; var cv = false; var fh = false; var dF = null; var jX = 0; var mV = 0; var cc = null; var mq = 0; var lp = 0; var na; var mj; var mw; var lM; var kJ; var jf; var cI = null; var be = null; var ik = null; var lE; var ng; var lC; var nq; var hu = new Array(); var fW = new Array(); var hf = new Array(); var gC = new Array(); var tQ = false; var ti = function() { dF = $("div_TableResizeSepV"); dF.className = "TableResizeSepV"; cc = $("div_TableResizeSepH"); cc.className = "TableResizeSepH"; H.bM(document, 'mousemove', EWEBTableResize.pw); }; var fd = function() { bY = false; cv = false; fh = false; cI = null; be = null; ik = null; hu.length = 0; fW.length = 0; hf.length = 0; gC.length = 0; dF.style.display = "none"; cc.style.display = "none"; }; var qk = function(aH) { var n = aH.offsetWidth; n = n - hC(H.aU(aH, "padding-left")); n = n - hC(H.aU(aH, "padding-right")); return n; }; var qj = function(aH) { var n = aH.offsetHeight; n = n - hC(H.aU(aH, "padding-top")); n = n - hC(H.aU(aH, "padding-bottom")); return n; }; var or = function(aH) { if (isNaN(parseInt(aH.rowSpan))) { return 1; } else { return parseInt(aH.rowSpan); } }; var hC = function(ah) { if (!ah) { return 0; } if (isNaN(parseInt(ah))) { return 0; } ah = ah.toLowerCase(); if (parseFloat(ah) == 0) { return 0; } else if (ah.fc("px")) { return parseInt(ah); } else if (ah.fc("pt")) { return parseInt(parseFloat(ah) * 4 / 3); } else if (ah.fc("cm")) { return parseInt(parseFloat(ah) * 28.35 * 4 / 3); } else if (ah.fc("mm")) { return parseInt(parseFloat(ah) * 0.001 * 28.35 * 4 / 3); } else { return 0; } }; var nF = function() { dF.style.display = "none"; cc.style.display = "none"; if (bY) { dF.style.cursor = "e-resize"; dF.style.display = ""; } if (cv) { cc.style.cursor = "s-resize"; cc.style.display = ""; } if (bY && cv) { dF.style.cursor = "se-resize"; cc.style.cursor = "se-resize"; } }; return { Ah: function() { return fh; }, MM: function(e) { if (fh) { this.MM2(e); return; } if (!tQ) { ti(); } fd(); var R = e.srcElement || e.target; while (R.tagName.toUpperCase() != "TD" && R.tagName.toUpperCase() != "TH") { if (R.tagName.toUpperCase() == "BODY" || R.tagName.toUpperCase() == "HTML") { fd(); return; } R = R.parentNode; if (!R) { fd(); return; } } cI = R; var hT = 0; var cu = 0; while (R) { hT += R.offsetLeft; cu += R.offsetTop; R = R.offsetParent; } var ni = H.gT(O.aG); var lU = hT + cI.offsetWidth - ni.X; mw = e.screenX - e.clientX; kJ = lU - mT; if (e.clientX > kJ) { bY = true; } var np = cu + cI.offsetHeight - ni.Y; lM = e.screenY - e.clientY; jf = np - mT; if (e.clientY > jf) { cv = true; } if (bY || cv) { jX = lU + $("eWebEditor").offsetLeft + $("eWebEditor_Layout").offsetLeft; mV = $("eWebEditor").offsetTop + $("eWebEditor_Layout").offsetTop + $("eWebEditor_ToolarPTR").offsetHeight; dF.style.left = jX + "px"; dF.style.top = mV + "px"; dF.style.width = mo + "px"; dF.style.height = $("eWebEditor").offsetHeight + "px"; mq = $("eWebEditor").offsetLeft + $("eWebEditor_Layout").offsetLeft; lp = np + $("eWebEditor").offsetTop + $("eWebEditor_Layout").offsetTop + $("eWebEditor_ToolarPTR").offsetHeight; cc.style.left = mq + "px"; cc.style.top = lp + "px"; cc.style.width = $("eWebEditor").offsetWidth + "px"; cc.style.height = mo + "px"; } nF(); }, MD2: function(e) { if (!e) { e = eWebEditor.event; } if (t.bu && e.button != 1) { return; } fh = true; na = e.screenX; mj = e.screenY; be = H.uR(cI, "TABLE"); if (bY) { ng = be.offsetWidth; be.style.width = be.offsetWidth; lE = cI.offsetWidth; for (var i = 0; i < be.rows.length; i++) { for (var j = 0; j < be.rows[i].cells.length; j++) { var aH = be.rows[i].cells[j]; aH.style.width = qk(aH); aH.removeAttribute("width"); } } hu.length = 0; fW.length = 0; var n = 0; for (var i = 0; i < be.rows.length; i++) { for (var j = 0; j < be.rows[i].cells.length; j++) { var aH = be.rows[i].cells[j]; if ((aH.offsetLeft + aH.offsetWidth) >= (cI.offsetLeft + cI.offsetWidth) && (aH.offsetLeft < (cI.offsetLeft + cI.offsetWidth))) { hu[n] = aH; fW[n] = parseInt(aH.style.width); n++; break; } } } } if (cv) { ik = cI.parentNode; lC = be.offsetHeight; be.style.height = be.offsetHeight; nq = cI.offsetHeight; for (var i = 0; i < be.rows.length; i++) { for (var j = 0; j < be.rows[i].cells.length; j++) { var aH = be.rows[i].cells[j]; aH.style.height = qj(aH); aH.removeAttribute("height"); } } hf.length = 0; gC.length = 0; var n = 0; var ja = ik.rowIndex + or(ik); for (var i = 0; i < ja; i++) { for (var j = 0; j < be.rows[i].cells.length; j++) { var aH = be.rows[i].cells[j]; if ((or(aH) + i) >= ja && i < ja) { hf[n] = aH; gC[n] = parseInt(aH.style.height); n++; } } } } }, MM2: function(e) { if (!e) { e = eWebEditor.event; } if (t.bu && e.button != 1 && fh) { fd(); } if (!fh) { var gJ = false; if (e.screenX - mw > kJ) { if (!bY) { gJ = true; bY = true; } } else { if (bY) { gJ = true; bY = false; } } if (e.screenY - lM > jf) { if (!cv) { gJ = true; cv = true; } } else { if (cv) { gJ = true; cv = false; } } if (gJ) { nF(); } return; } if (bY) { var eu = e.screenX - na; var hq = eu; if (be.align.toLowerCase() == "center") { hq = 2 * hq; } var ve = hq + lE; var uG = hq + ng; if (ve >= 2) { be.style.width = uG + "px"; dF.style.left = (jX + eu) + "px"; for (var i = 0; i < hu.length; i++) { try { hu[i].style.width = (hq + fW[i]) + "px"; } catch (qt) { } } } } if (cv) { var eu = e.screenY - mj; var tC = eu + nq; var tI = eu + lC; if (tC >= 2) { be.style.height = tI + "px"; cc.style.top = (lp + eu) + "px"; for (var i = 0; i < hf.length; i++) { try { hf[i].style.height = (eu + gC[i]) + "px"; } catch (qt) { } } } } }, MU2: function(e) { if (!fh) { return; } fd(); }, pw: function(e) { if (!e) { e = window.event; } if (t.bu && e.button != 1 && fh) { fd(); } } }; })(); var EWEBHistory = (function() { var cb = []; var ar = 0; var cC = []; var gU = false; var nV = function() { var jv = cC[ar]; if (jv) { if (t.bu) { eWebEditor_Layout.focus(); if (jv.substring(0, 8) != "[object]") { var r = O.J.body.createTextRange(); if (r.moveToBookmark(cC[ar])) { r.select(); } } else { if (O.aj == "EDIT") { var r = O.J.body.createControlRange(); var a = jv.split("|"); var bz = O.J.body.getElementsByTagName(a[1]); var R = bz[a[2]]; r.addElement(R); r.select(); } } } else { } } }; var sV = function(R) { var bz = O.J.body.getElementsByTagName(R.tagName); for (var i = 0; i < bz.length; i++) { if (bz[i] == R) { return i; } } return null; }; return { qU: function() { if (cb.length <= 1 || ar <= 0) { return false; } return true; }, pW: function() { if (ar >= cb.length - 1 || cb.length == 0) { return false; } return true; }, ig: function() { gU = false; }, Save: function() { if (gU) { return; } gU = true; var K = getHTML(); if (cb[ar] == K) { return; } var uM = cb.length; var uy = cb.length - ar; for (var i = 1; i < uy; i++) { cb.pop(); cC.pop(); } cb[cb.length] = K; if (t.bu) { if (V.bC() != "Control") { try { cC[cC.length] = O.J.selection.createRange().getBookmark(); } catch (e) { cC[cC.length] = ""; } } else { var R = V.aW(); cC[cC.length] = "[object]|" + R.tagName + "|" + sV(R); } } else { try { cC[cC.length] = O.aG.getSelection().getRangeAt(0).endContainer; } catch (e) { cC[cC.length] = ""; } } if (uM != 0) { ar++; } }, Go: function(v) { if (!gU) { this.Save(); } if (v == -1) { if (ar > 0) { ar = ar - 1; setHTML(cb[ar], true); nV(); } } else { if (ar < cb.length - 1) { ar = ar + 1; setHTML(cb[ar], true); nV(); } } O.Focus(); dK.gp(); } }; })(); var aI; function fv(oQ) { if (aI) { aI = null; } var b = false; try { aI = new ActiveXObject("eWebSoft.eWebEditor3"); var mJ = aI.Version; if (parseFloat(mJ.replace(/[^0123456789]+/gi, "")) >= 3200) { aI.Lang = "zh-cn"; aI.SendUrl = O.SendUrl; aI.LocalSize = config.AllowLocalSize; aI.LocalExt = config.AllowLocalExt; b = true; } } catch (e) { } if (!b && oQ) { af("installactivex.htm", true); } return b; }; function eE() {
    var eb = aI.Error;if (eb != "") {
        var hF, fY; if (eb.indexOf(":") >= 0) { var a = eb.split(":"); hF = a[0]; fY = a[1]; } else { hF = eb; fY = ""; }
       
        switch (hF) {
            case "L": 
                alert(lang["ErrLicense"]);
                break; 
            case "InvalidFile":
                alert(lang["ErrInvalidFile"] + ":" + fY);
                break;
            default:
                alert(eb);
        }
        return true;
    }
    return false;
}; var O = { J: null, aG: null, aj: null, ad: null, BaseHref: "", cd: "", ic: "", SendUrl: "", ReadyState: "", Focus: function() { if (O.aj == "CODE" || O.aj == "TEXT") { O.df.focus(); return; } if (t.bu) { if (config.FixWidth) { if (document.activeElement.id != "eWebEditor") { eWebEditor.focus(); } try { var aX = O.J.selection.createRange(); if (aX.parentElement().tagName == "BODY") { aX.moveToElementText(O.J.getElementById("eWebEditor_FixWidth_DIV")); aX.collapse(true); aX.select(); } else { aX.select(); } } catch (e) { } } else { eWebEditor.focus(); } } else { this.aG.focus(); } }, Init: function() {

if (!config.L) { return; }

if (!t.kf) { return; } this.ic = document.location.protocol.toLowerCase() + "//" + document.location.host; var s = document.location.pathname; this.cd = s.substr(0, s.length - 15); this.BaseHref = ""; if (config.BaseHref != "") { this.BaseHref = "<base href='" + this.ic + config.BaseHref + "'></base>"; } if (az.ExtCSS) { this.ExtCSS = "<link href='" + tW(az.ExtCSS) + "' type='text/css' rel='stylesheet'>"; } else { this.ExtCSS = ""; } if (az.Skin) { config.Skin = az.Skin; } if (az.FixWidth) { config.FixWidth = az.FixWidth; } if (az.AreaCssMode) { config.AreaCssMode = az.AreaCssMode; } if (az.ReadOnly) { config.InitMode = "VIEW"; if (az.ReadOnly == "2") { config.StateFlag = ""; } else { config.SBCode = ""; config.SBEdit = ""; config.SBText = ""; config.SBView = ""; } } this.SendUrl = this.ic + this.cd + "/" + config.ServerExt + "/upload." + config.ServerExt + "?style=" + az.StyleName + "&cusdir=" + az.CusDir + "&sparams=" + config.SParams; H.bM(document, 'contextmenu', gO); H.bM(document, 'dragstart', gO); H.bM(document, 'selectstart', gO); H.bM(document, 'select', gO); if (t.jW && !t.kU) { window.onresize = function(e) { if (e && e.originalTarget !== document && e.originalTarget !== window && (!e.originalTarget.ownerDocument || e.originalTarget.ownerDocument != document)) { return; } jQ(); }; } 
} 
}; O.jY = function() { var bL = this.J; if (t.bu) { if (config.FixWidth) { bL.body.contentEditable = false; fC = bL.getElementById("eWebEditor_FixWidth_DIV"); fC.contentEditable = true; } else { bL.body.contentEditable = true; } bL.execCommand("2D-Position", true, true); } else { try { bL.designMode = 'on'; bL.execCommand("styleWithCSS", false, "true"); bL.execCommand("enableInlineTableEditing", false, "false"); if (config.EnterMode == "2") { bL.execCommand("insertBrOnReturn", false, "true"); } if (config.FixWidth) { bL.designMode = 'off'; fC = bL.getElementById("eWebEditor_FixWidth_DIV"); fC.contentEditable = "true"; } } catch (e) { H.bM(this.aG.frameElement, 'DOMAttrModified', pq); } } }; function pq(dv) { if (O.jl) { window.clearTimeout(O.jl); } O.jl = H.mR(pF, 1000, O); }; function pF() { delete this.jl; H.nT(this.aG.frameElement, 'DOMAttrModified', pq); this.jY(); }; function gO(e) { if (O.aj == "EDIT" || O.aj == "VIEW") { return H.as(e); } }; function jQ() { var ho = $('eWebEditor'); if (ho) { var mG = ho.parentNode; ho.style.width = (mG.scrollWidth - 4) + 'px'; ho.style.height = (mG.scrollHeight - 4) + 'px'; ho.style.height = "100%"; } else { window.setTimeout(jQ, 10); } }; var config = new Object(); window.onload = qN; function qN() {

if (!config.L) { return; } 

if (O.ReadyState) { return; } O.ReadyState = "loading"; H.oJ(window); if (!t.kf) { return; } O.ad = parent.document.getElementsByName(az.ad)[0]; if (t.jW && !t.kU) { jQ(); } dK.sl(); H.iy(document.body); if (t.bu) { } else { $("eWebEditorTextarea").style.MozUserSelect = "text"; } O.aG = $("eWebEditor").contentWindow; O.J = O.aG.document; O.df = $("eWebEditorTextarea"); if (!t.kf) { config.InitMode = "TEXT"; } if ($("D_ContentFlag").value == "0") { $("D_ContentEdit").value = O.ad.value; $("D_ContentLoad").value = O.ad.value; $("D_CurrMode").value = config.InitMode; $("D_ContentFlag").value = "1"; } setMode($("D_CurrMode").value, true); uU(); O.ReadyState = "complete"; try { parent.EWEBEDITOR_OnLoadComplete(az.ad); } catch (e) { } }; function uU() { if (!O.ad) { return; } var aB = O.ad.form; if (!aB) { return; } H.bM(aB, 'submit', nz); if (!aB.submitEditor) { aB.submitEditor = new Array(); } aB.submitEditor[aB.submitEditor.length] = nz; if (!aB.originalSubmit) { aB.originalSubmit = aB.submit; aB.submit = function() { if (this.submitEditor) { for (var i = 0; i < this.submitEditor.length; i++) { this.submitEditor[i](); } } this.originalSubmit(); }; } H.bM(aB, 'reset', nQ); if (!aB.eI) aB.eI = new Array(); aB.eI[aB.eI.length] = nQ; if (!aB.originalReset) { aB.originalReset = aB.reset; aB.reset = function() { if (this.eI) { for (var i = 0; i < this.eI.length; i++) { this.eI[i](); } } this.originalReset(); }; } }; function nz() { var aB = O.ad.form; if (!aB) { return; } var K = getHTML(); if (config.PaginationMode != "0" && config.PaginationAutoFlag != "0") { if (O.aj != "EDIT") { setMode("EDIT"); } var b = true; if (config.PaginationAutoFlag == "1") { var bz = O.J.getElementsByTagName("IMG"); for (var i = 0; i < bz.length; i++) { var ce = bz[i].getAttribute("eWebEditorFake", 2); if (ce) { if (ce.toLowerCase() == "pagination") { b = false; break; } } } } if (b) { EWEBPagination.Auto(config.PaginationAutoNum); K = getHTML(); } } $("D_ContentEdit").value = K; mf(O.ad, K); }; function nQ() { setHTML($("D_ContentLoad").value); }; function qz() { var ep = O.ad.form; if (!ep) { return; } if (ep.onsubmit) { if (ep.onsubmit()) { ep.submit(); } } else { ep.submit(); } }; function nt(e) { af('about.htm'); return H.as(e); }; function vg(e) { if (!e) { e = eWebEditor.event; } if (t.bu) { return H.as(e); } else { if (config.AutoDetectPaste == "2") { window.setTimeout("pasteText()", 10); return H.as(e); } EWEBHistory.Save(); return true; } }; function uf(e) { if (!e) { e = eWebEditor.event; } var aq = e.keyCode || e.which; var ag = String.fromCharCode(aq).toUpperCase(); if (e.ctrlKey || ((aq >= 33) && (aq <= 40)) || (aq == 13) || (aq == 8) || (aq == 46)) { dK.gp(); } return true; }; function uK(e) { if (!e) { e = eWebEditor.event; } var aq = e.keyCode || e.which; var ag = String.fromCharCode(aq).toUpperCase(); var ay = false; if (aq == 112 && !t.bu) { af("about.htm"); ay = true; } if (aq == 113) { EWEBCommandShowBorders.Execute(); ay = true; } if (aq == 114) { EWEBCommandShowBlocks.Execute(); ay = true; } if (e.ctrlKey) { if (aq == 13) { qz(); ay = true; } if (aq == 187 || aq == 107) { gv(300); ay = true; } if (aq == 189 || aq == 109) { gv(-300); ay = true; } if (ag == "1") { setMode("CODE"); ay = true; } if (ag == "2") { setMode("EDIT"); ay = true; } if (ag == "3") { setMode("TEXT"); ay = true; } if (ag == "4") { setMode("VIEW"); ay = true; } if (ag == "A") { if ((O.aj != "CODE") && (config.FixWidth)) { mz(); } else { O.Focus(); EWEBHistory.Save(); O.J.execCommand("SelectAll", false, null); EWEBHistory.Save(); O.Focus(); } ay = true; } if (ag == "D") { pasteWord(); ay = true; } if (ag == "R") { oy(); ay = true; } if (ag == "Z") { EWEBHistory.Go(-1); ay = true; } if (ag == "Y") { EWEBHistory.Go(1); ay = true; } if (ag == "V" && t.bu) { window.setTimeout("pN()", 10); ay = true; } } if ((config.EnterMode == "2") && (aq == 13) && t.bu) { EWEBHistory.Save(); EWEBHistory.ig(); var aX = O.J.selection.createRange(); if (e.shiftKey) { var p = aX.parentElement(); if (p.tagName != "P" || p.innerHTML == "") { aX.pasteHTML("&nbsp;"); aX.select(); aX.collapse(false); } try { aX.pasteHTML("</P><P id=eWebEditor_Temp_P>"); } catch (sm) { return false; } e.cancelBubble = true; e.returnValue = false; var R = O.J.getElementById("eWebEditor_Temp_P"); if (R.innerHTML == "") { R.innerHTML = "&nbsp;"; } aX.moveToElementText(R); aX.select(); aX.collapse(false); aX.select(); R.removeAttribute("id"); } else { try { aX.pasteHTML("<br>"); } catch (sm) { return false; } e.cancelBubble = true; e.returnValue = false; aX.select(); aX.moveEnd("character", 1); aX.moveStart("character", 1); aX.collapse(false); } ay = true; } if (ay) { return H.as(e); } else { if ((aq == 13) || (aq == 8) || (aq == 46)) { EWEBHistory.Save(); EWEBHistory.ig(); } else if ((aq >= 33) && (aq <= 40)) { EWEBHistory.Save(); } else if (!((e.ctrlKey && ag == "A") || (e.ctrlKey && ag == "F"))) { EWEBHistory.ig(); } return true; } }; function tL(e) { }; function ty(e) { if (!e) { e = eWebEditor.event; } EWEBTableResize.MU2(e); EWEBHistory.Save(); dK.gp(); }; function uD(e) { if (!e) { e = eWebEditor.event; } EWEBTableResize.MM(e); }; function ss() { EWEBHistory.Save(); return true; }; function tW(aE) { if (aE.indexOf("://") >= 0) { return aE; } if (aE.substr(0, 1) == "/") { return aE; } var gQ = O.cd; while (aE.substr(0, 3) == "../") { aE = aE.substr(3); gQ = gQ.substring(0, gQ.lastIndexOf("/")); } return gQ + "/" + aE; }; function insertHTML(K) { if (mP()) { return; } switch (O.aj) { case "EDIT": V.eS(); O.Focus(); K = bo.je(K); if (t.bu) { if (O.J.selection.type.toLowerCase() == "control") { O.J.selection.clear(); } K = '<span id="__ewebeditor_temp_remove__" style="display:none;">eWebEditor</span>' + K; O.J.selection.createRange().pasteHTML(K); O.J.getElementById('__ewebeditor_temp_remove__').removeNode(true); } else { var nv = O.J.createDocumentFragment(); var lo = O.J.createElement('div'); lo.innerHTML = K; var lV; while ((lV = lo.firstChild)) { nv.appendChild(lo.removeChild(lV)); } var fp = O.aG.getSelection().getRangeAt(0); fp.deleteContents(); fp.insertNode(nv); } dK.gp(); break; case "TEXT": case "CODE": O.df.focus(); if (t.bu) { O.J.selection.createRange().text = K; } else { O.df.execCommand("insertHTML", false, K); } break; } }; function setHTML(K, rG) { $("D_ContentEdit").value = K; switch (O.aj) { case "CODE": O.df.value = ub.un(K); break; case "TEXT": K = K.replace(/<script[^>]*?>(?:[^a]|a)*?<\/script>/gi, ""); K = K.replace(/<style[^>]*?>(?:[^a]|a)*?<\/style>/gi, ""); K = K.replace(/<object[^>]*?>(?:[^a]|a)*?<\/object>/gi, ""); K = K.replace(/<embed[^>]*?>(?:[^a]|a)*?<\/embed>/gi, ""); K = K.replace(/<table[^>]*?>(?:[^a]|a)*?<\/table>/gi, ""); $("eWebEditor_Temp_HTML").innerHTML = K; if (t.bu) { K = $("eWebEditor_Temp_HTML").innerText; } else { K = iJ($("eWebEditor_Temp_HTML")); } O.df.value = K; break; case "EDIT": O.J.designMode = "on"; O.J.open(); O.J.write(os(bo.je(K))); O.J.close(); O.jY(); H.bM(O.J.body, 'paste', vg); H.bM(O.J, 'help', nt); H.bM(O.J.body, 'dragend', ss); H.bM(O.J, 'keydown', uK); H.bM(O.J, 'keyup', uf); H.bM(O.J, 'contextmenu', EWEBMenu.uv); H.bM(O.J, 'mousedown', tL); H.bM(O.J, 'mouseup', ty); H.bM(O.J, 'mousemove', uD); if (t.bu) { if (config.FixWidth) { H.bM(O.J.getElementById("eWebEditor_FixWidth_DIV"), 'beforedeactivate', function() { V.Save(); }); } else { H.bM(O.J, 'beforedeactivate', function() { V.Save(); }); } } break; case "VIEW": O.J.designMode = "off"; O.J.open(); O.J.write(os(K)); O.J.close(); H.bM(O.J, 'help', nt); H.bM(O.J, 'contextmenu', H.as); break; } if (!rG) { EWEBHistory.Save(); } }; function getHTML(ql) { var K; switch (O.aj) { case "CODE": K = O.df.value; break; case "EDIT": EWEBPagination.uW(); if (config.FixWidth) { K = O.J.getElementById("eWebEditor_FixWidth_DIV").innerHTML; } else { K = O.J.body.innerHTML; } K = bo.uN(K); break; case "VIEW": K = $("D_ContentEdit").value; break; case "TEXT": K = O.df.value; K = eK(K); break; default: K = $("D_ContentEdit").value; break; } if (!ql) { if ((K.toLowerCase() == "<p>&nbsp;</p>") || (K.toLowerCase() == "<p></p>") || (K.toLowerCase() == "<br>")) { K = ""; } } return K; }; function appendHTML(K) { if (mP()) { return; } switch (O.aj) { case "EDIT": K = bo.je(K); O.J.body.innerHTML += K; break; case "CODE": case "TEXT": O.df.value += K; break; } }; function openUploadDialog(db, qI, qw, qo, qp) { dm.OpenDialog('i_upload.htm?type=' + db + '&mode=' + qI + '&savepathfilename=' + qw + '&savefilename=' + qo + '&originalfilename=' + qp); }; function eG() { if (O.aj == "EDIT") { return true; } alert(lang["MsgOnlyInEditMode"]); return false; }; function mP() { if (O.aj == "VIEW") { alert(lang["MsgCanotSetInViewMode"]); return true; } return false; }; function hH() { if (t.bu) { return true; } alert(lang["MsgOnlyForIE"]); return false; }; function format(aT, fM) { if (!eG()) { return; } V.eS(); O.aG.focus(); O.Focus(); EWEBHistory.Save(); if ((aT == "unselect") && (!t.bu)) { V.Collapse(true); } else if ((aT == "selectall") && (config.FixWidth)) { mz(); } else { O.J.execCommand(aT, false, fM); } EWEBHistory.Save(); O.Focus(); dK.gp(); }; function mz() { if (t.bu) { var r = O.J.body.createTextRange(); r.moveToElementText(O.J.getElementById("eWebEditor_FixWidth_DIV")); r.select(); } else { var r = V.bd().getRangeAt(0); r.selectNodeContents(O.J.getElementById("eWebEditor_FixWidth_DIV")); } }; function mn(s) { var r; switch (s + "") { case "1": r = "8pt"; break; case "2": r = "10pt"; break; case "3": r = "12pt"; break; case "4": r = "14pt"; break; case "5": r = "18pt"; break; case "6": r = "24pt"; break; case "7": r = "36pt"; break; default: r = ""; break; } return r; }; function setMode(dE, sk) { if (dE == O.aj) { return; } if (dE == "TEXT") { if (O.aj == $("D_CurrMode").value) { if (!confirm(lang["MsgHtmlToText"])) { return; } } } try { $("eWebEditor_CODE").className = "SB_Mode_BtnOff"; } catch (e) { } try { $("eWebEditor_EDIT").className = "SB_Mode_BtnOff"; } catch (e) { } try { $("eWebEditor_TEXT").className = "SB_Mode_BtnOff"; } catch (e) { } try { $("eWebEditor_VIEW").className = "SB_Mode_BtnOff"; } catch (e) { } try { $("eWebEditor_" + dE).className = "SB_Mode_BtnOn"; } catch (e) { } if (az.ReadOnly) { $("eWebEditor_ToolarTREdit").style.display = "none"; $("eWebEditor_ToolarTRText").style.display = "none"; } else { if (dE == "EDIT") { $("eWebEditor_ToolarTREdit").style.display = ""; $("eWebEditor_ToolarTRText").style.display = "none"; } else { $("eWebEditor_ToolarTREdit").style.display = "none"; if (config.TB2Flag == "1") { $("eWebEditor_ToolarTRText").style.display = ""; } else { $("eWebEditor_ToolarTRText").style.display = "none"; } } } if (dE == "EDIT" || dE == "VIEW") { $("eWebEditor").style.display = ""; $("eWebEditorTextarea").style.display = "none"; } else { $("eWebEditor").style.display = "none"; $("eWebEditorTextarea").style.display = ""; if (dE == "CODE") { $("eWebEditorTextarea").className = "codemode"; } else { $("eWebEditorTextarea").className = "textmode"; } } var K = getHTML(true); O.aj = dE; $("D_CurrMode").value = dE; setHTML(K); if (dE == "EDIT") { EWEBCommandShowBlocks.jG(); EWEBCommandShowBorders.jG(); } dK.rm(); if (!sk) { O.Focus(); } }; function iJ(R) { var sF = ["p", "div", "h1", "h2", "h3", "h4", "h5", "h6", "pre", "ol", "ul", "pre", "fieldset", "form", "table", "blockquote", "dl", "li", "br"]; var sA = ["script", "style", "table", "object", "embed"]; var bD = ""; var cn = R.childNodes; for (var i = 0; i < cn.length; i++) { if (cn[i].nodeType == 1) { var ae = cn[i].tagName.toLowerCase(); if (sA.eD(ae) < 0) { if (ae == "pre") { var kY = cn[i].innerHTML; kY = kY.replace(/<[^>]*?>/gi, ""); bD += kY; } else { bD += iJ(cn[i]); } } if (sF.eD(ae) >= 0) { bD += "\n"; } } else if (cn[i].nodeType == 3) { bD += cn[i].nodeValue; } } return bD; }; function af(aE, pI, qW) { if (pI && !eG()) { return; } if (qW && !hH()) { return; } if (aE.indexOf(".") < 0) { aE = aE + ".htm"; } EWEBHistory.Save(); dm.OpenDialog(aE); }; function eK(K) { if (K == null) { return ""; } K = K.replace(/&/gi, "&amp;"); K = K.replace(/\"/gi, "&quot;"); K = K.replace(/</gi, "&lt;"); K = K.replace(/>/gi, "&gt;"); K = K.replace(/ (?= )/gi, "&nbsp;"); K = K.replace(/\n/gi, "<br>"); return K; }; function uQ(K) { if (K == null) { return ""; } K = K.replace(/<br(?=[ \/>]).*?>/gi, "\n"); K = K.replace(/&nbsp;;/gi, " "); K = K.replace(/&quot;/gi, "\""); K = K.replace(/&lt;/gi, "<"); K = K.replace(/&gt;/gi, ">"); K = K.replace(/&amp;/gi, "&"); return K; }; function addUploadFile(cf, fe) { var qQ = fe.substr(fe.lastIndexOf("/") + 1); hN(az.rF, cf); hN(az.sd, qQ); hN(az.sp, fe); }; function hN(hm, ah) { if (ah == "") { return; } if (hm) { var dj = parent.document.getElementById(hm); if (!dj) { dj = parent.document.getElementsByName(hm)[0]; } if (dj) { if (dj.value != "") { dj.value = dj.value + "|"; } dj.value = dj.value + ah; try { dj.onchange(); } catch (e) { } } } }; function mf(he, K) { he.value = K; var mQ = he.name; var ep = he.form; var nd = H.fg(he); var hj = 50000; var bz = nd.getElementsByName(mQ); for (var i = 1; i < bz.length; i++) { bz[i].value = ""; } if (K.length > hj) { he.value = K.substr(0, hj); K = K.substr(hj); while (K.length > 0) { var iZ = nd.createElement("textarea"); iZ.setAttribute("name", mQ); iZ.style.display = "none"; iZ.value = K.substr(0, hj); ep.appendChild(iZ); K = K.substr(hj); } } }; var jj; function remoteUpload(qY) { if (config.AutoRemote != "1") { return; } if (O.aj == "TEXT") { return; } jj = qY; var rk = document.getElementsByName("eWebEditor_UploadText")[0]; mf(rk, getHTML()); nZ(lang["MsgRemoteUploading"]); $("eWebEditor_UploadForm").submit(); }; function remoteUploadOK() { $("divProcessing").style.display = "none"; if (O.ad) { if (jj) { eval("parent." + jj); } } }; function localUpload() { if (!hH()) { return; } if (O.aj == "TEXT") { return; } if (!fv(true)) { return; } nZ(lang["MsgLocalUploading"]); var eO = getHTML(); aI.LocalUpload(eO); window.setTimeout("LocalUploadStatus()", 100); }; function LocalUploadStatus() { if (aI.Status != "ok") { window.setTimeout("LocalUploadStatus()", 100); return; } if (eE()) { $("divProcessing").style.display = "none"; return; } var fw = aI.OriginalFiles; var fP = aI.SavedFiles; if (fw) { var fN = fw.split("|"); var fa = fP.split("|"); for (var i = 0; i < fN.length; i++) { if (fa[i]) { var cf = fN[i]; var fe = fa[i]; addUploadFile(cf, fe); } } } var eO = aI.Body; setHTML(eO, true); aI = null; $("divProcessing").style.display = "none"; }; function nZ(su) { $("msgProcessing").innerHTML = su; $("divProcessing").style.top = (document.body.clientHeight - parseFloat($("divProcessing").style.height)) / 2; $("divProcessing").style.left = (document.body.clientWidth - parseFloat($("divProcessing").style.width)) / 2; $("divProcessing").style.display = ""; }; function os(K) { var ee = '<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN"><html><head>'; ee += '<link href="' + O.cd + '/skin/' + config.Skin + '/editarea.css" type="text/css" rel="stylesheet">'; switch (O.aj) { case 'CODE': break; case 'TEXT': break; case 'EDIT': case 'VIEW': if (config.AreaCssMode != '1') { ee += '<link href="' + O.cd + '/skin/' + config.Skin + '/editarea.zh-cn.css" type="text/css" rel="stylesheet">'; } ee += O.ExtCSS; break; } ee += O.BaseHref + '</head>'; var aY = ee; if (config.FixWidth) { aY += '<body class="ewebeditor__fixwidth">' + '<div id="eWebEditor_FixWidth_DIV" style="width:' + config.FixWidth + ';" >'; if (!t.bu && K == '') { aY += '<br>'; } aY += K + '</div></body>'; } else { aY += '<body>' + K + '</body>'; } return aY; }; function getCount(iu) { var av = getText(); av = av.replace(/\n/g, ""); av = av.replace(/\r/g, ""); var l = av.length; var n = 0; for (var i = 0; i < l; i++) { if (av.charCodeAt(i) < 0 || av.charCodeAt(i) > 255) { if (iu != 0) { n++; if (iu == 3) { n++; } } } else { if (iu != 1) { n++; } } } return n; }; function getText() { var bD; if (O.aj == "TEXT") { bD = O.df.value; } else { $("eWebEditor_Temp_HTML").innerHTML = getHTML(); if (t.bu) { bD = $("eWebEditor_Temp_HTML").innerText; } else { bD = iJ($("eWebEditor_Temp_HTML")); } } return bD; };

function kl(url) { document.write('<scr' + 'ipt type="text/javascript" src="' + url + '" onerror="alert(\'Error loading \' + this.src);"><\/scr' + 'ipt>'); };

function wb() {
    if (!config.L) {
        document.write("<table style='width:100%;height:100%;border-collapse:collapse' borderColor='#999999' bgColor='#ffffff' border='1px'><tr><td align='center' style='font-size:9pt'>eWebEditor!<br><br>" + lang["ErrLicense"] + "</td></tr></table>");
        return; 
    }

var bP="";bP+="<table id='eWebEditor_Layout' border='0' cellpadding='0' cellspacing='0' width='100%' height='100%' style='table-layout:fixed'>";bP+="<tr id='eWebEditor_ToolarPTR'><td>";bP+="<table id='eWebEditor_Toolbar' border=0 cellpadding=0 cellspacing=0 width='100%'>";bP+="<tr id='eWebEditor_ToolarTRText' style='display:none'><td>";bP+=nc(sq(),"Text");bP+="</td></tr>";bP+="<tr id='eWebEditor_ToolarTREdit' style='display:'><td>";bP+=nc(config.Toolbars,"Edit");bP+="</td></tr>";bP+="</table>";bP+="</td></tr>";bP+="<tr><td id='eWebEditor_EditareaTD' height='100%'>";bP+="<input type='hidden' id='D_ContentEdit' value=''>";bP+="<input type='hidden' id='D_CurrMode' value=''>";bP+="<input type='hidden' id='D_ContentLoad' value=''>";bP+="<input type='hidden' id='D_ContentFlag' value='0'>";bP+="<input type='hidden' id='D_PaginationTitle' value=''>";bP+="<textarea id='eWebEditorTextarea' style='display:none;width:100%;height:100%;'></textarea>";bP+='<iframe id="eWebEditor" width="100%" height="100%" scrolling="yes" frameborder="0" src="'+H.ib()+'"></iframe>';bP+="</td></tr>";if(config.StateFlag){bP+="<tr><td class='SB'>";bP+="	<table border='0' cellpadding='0' cellspacing='0' width='100%' class='SB'>";bP+="	<tr valign='middle'>";bP+="	<td>";bP+="		<table border='0' cellpadding='0' cellspacing='0' class='SB_Mode'>";bP+="		<tr>";bP+="		<td class='SB_Mode_Left'></td>";if(config.SBCode){bP+="		<td class=SB_Mode_BtnOff id=eWebEditor_CODE onclick=\"setMode('CODE')\" unselectable=on><table border=0 cellpadding=0 cellspacing=0><tr><td class=SB_Mode_Btn_Img>"+eF("ModeCode")+"</td><td class=SB_Mode_Btn_Text>"+lang["StatusModeCode"]+"</td></tr></table></td>";bP+="		<td class=SB_Mode_Sep></td>";}if(config.SBEdit){bP+="		<td class=SB_Mode_BtnOff id=eWebEditor_EDIT onclick=\"setMode('EDIT')\" unselectable=on><table border=0 cellpadding=0 cellspacing=0><tr><td class=SB_Mode_Btn_Img>"+eF("ModeEdit")+"</td><td class=SB_Mode_Btn_Text>"+lang["StatusModeEdit"]+"</td></tr></table></td>";bP+="		<td class=SB_Mode_Sep></td>";}if(config.SBText){bP+="		<td class=SB_Mode_BtnOff id=eWebEditor_TEXT onclick=\"setMode('TEXT')\" unselectable=on><table border=0 cellpadding=0 cellspacing=0><tr><td class=SB_Mode_Btn_Img>"+eF("ModeText")+"</td><td class=SB_Mode_Btn_Text>"+lang["StatusModeText"]+"</td></tr></table></td>";bP+="		<td class=SB_Mode_Sep></td>";}if(config.SBView){bP+="		<td class=SB_Mode_BtnOff id=eWebEditor_VIEW onclick=\"setMode('VIEW')\" unselectable=on><table border=0 cellpadding=0 cellspacing=0><tr><td class=SB_Mode_Btn_Img>"+eF("ModeView")+"</td><td class=SB_Mode_Btn_Text>"+lang["StatusModeView"]+"</td></tr></table></td>";}bP+="		</tr>";bP+="		</table>";bP+="	</td>";if(az.FullScreen!="1"&&config.SBSize){bP+="	<td align=right>";bP+="		<table border=0 cellpadding=0 cellspacing=0 class=SB_Size>";bP+="		<tr>";bP+="		<td class=SB_Size_Btn onclick='gv(300)' title='"+lang["SizePlus"]+"'>"+eF("SizePlus")+"</td>";bP+="		<td class=SB_Size_Sep></td>";bP+="		<td class=SB_Size_Btn onclick='gv(-300)' title='"+lang["SizeMinus"]+"'>"+eF("SizeMinus")+"</td>";bP+="		<td class=SB_Size_Right></td>";bP+="		</tr>";bP+="		</table>";bP+="	</td>";}bP+="	</tr>";bP+="	</Table>";bP+="</td></tr>";}bP+="</table>";bP+="<div id='eWebEditor_Temp_HTML' style='visibility:hidden;overflow:hidden;position:absolute;width:1px;height:1px'></div>";bP+="<div style='position:absolute;display:none'>";bP+="<form id='eWebEditor_UploadForm' action='"+config.ServerExt+"/upload."+config.ServerExt+"?action=remote&type=remote&style="+az.StyleName+"&language=zh-cn&cusdir="+az.CusDir+"&skey="+az.SKey+"' method='post' target='eWebEditor_UploadTarget'>";bP+="<input type='hidden' name='eWebEditor_UploadText'>";bP+="</form>";bP+='<iframe name="eWebEditor_UploadTarget" width=0 height=0 src="'+H.ib()+'"></iframe>';bP+="</div>";bP+="<div id=divProcessing style='width:200px;height:30px;position:absolute;display:none'>";bP+="<table border=0 cellpadding=0 cellspacing=1 bgcolor='#000000' width='100%' height='100%'><tr><td bgcolor=#3A6EA5><marquee id='msgProcessing' align='middle' behavior='alternate' scrollamount='5' style='font-size:9pt;color:#ffffff'></marquee></td></tr></table>";bP+="</div>";bP+="<div id='div_TableResizeSepV' style='position:absolute;display:none;background-color:transparent;overflow:hidden;' onmousedown='EWEBTableResize.MD2(event)' onmousemove='EWEBTableResize.MM2(event)' onmouseup='EWEBTableResize.MU2(event)'></div>";bP+="<div id='div_TableResizeSepH' style='position:absolute;display:none;background-color:transparent;overflow:hidden;' onmousedown='EWEBTableResize.MD2(event)' onmousemove='EWEBTableResize.MM2(event)' onmouseup='EWEBTableResize.MU2(event)'></div>";document.write(bP);};function nc(oh,qP){var aY="<table border='0' cellpadding='0' cellspacing='0' width='100%' id='eWebEditor_Toolbar_"+qP+"' unselectable>";for(var i=0;i<oh.length;i++){aY+="<tr><td class='TB_Left'></td><td class='TB_Center'><table border='0' cellpadding='0' cellspacing='0'><tr>";var tb=oh[i];for(var j=0;j<tb.length;j++){var ac=tb[j];var ck=Buttons[ac];if(ac=="TBSep"){aY+="<td class='TB_Btn_Padding'><div class='TB_Sep'></div></td>";}else if(ck[3]==0){aY+="<td class='TB_Btn_Padding'><div class='TB_Btn' name='TB_Name_"+ac+"' title=\""+lang[ac]+"\" onclick=\""+ck[1]+"\">";if(typeof(ck[0])=="number"){var dP="skin/"+config.Skin+"/buttons.gif";var cu=16-ck[0]*16;if(t.bu){aY+="<div class='TB_Btn_Image'><img src='"+dP+"' style='top:"+cu+"px' /></div>";}else{aY+="<img class='TB_Btn_Image' src='sysimage/space.gif' style='background-position: 0px "+cu+"px;background-image: url("+dP+");' />";}}else{var dP="skin/"+config.Skin+"/"+ck[0];aY+="<img class='TB_Btn_Image' src='"+dP+"'>";}aY+="</div></td>";}else if(ck[3]==1){var gA="";var cp="";switch(ac){case "FontName":gA=" style='width:115px'";for(var k=0;k<lang[ac+"Item"].length;k++){cp+="<option value='"+lang[ac+"Item"][k]+"'>"+lang[ac+"Item"][k]+"</option>";}break;case "FontSize":gA=" style='width:55px'";for(var k=0;k<lang[ac+"Item"].length;k++){cp+="<option value='"+lang[ac+"Item"][k][0]+"'>"+lang[ac+"Item"][k][1]+"</option>";}break;case "FormatBlock":gA=" style='width:90px'";for(var k=0;k<lang[ac+"Item"].length;k++){cp+="<option value='"+lang[ac+"Item"][k][0]+"'>"+lang[ac+"Item"][k][1]+"</option>";}break;case "ZoomSelect":gA=" style='width:55px'";for(var k=0;k<EWEBCommandZoom.Options.length;k++){cp+="<option value='"+EWEBCommandZoom.Options[k]+"'>"+EWEBCommandZoom.Options[k]+"%</option>";}break;}aY+="<td class='TB_Btn_Padding'><select name='TB_Name_"+ac+"' onchange=\""+ck[1]+"\" size=1 "+gA+"><option selected>"+lang[ac]+"</option>"+cp+"</select></td>";}}aY+="</tr></table></td><td class='TB_Right'></td></tr>";}aY+="</table>";return aY;};function sq(){var a=new Array();var b=false;a.push("TBHandle");if(config.TB2Mode=="1"){a.push("ModeCode");a.push("ModeEdit");a.push("ModeText");a.push("ModeView");b=true;}if(config.TB2Max=="1"){if(b){a.push("TBSep");}a.push("Maximize");}return[a];};function eF(ac,oq){var dA=Buttons[ac];var cu=16-dA[0]*16;var dP="skin/"+config.Skin+"/buttons.gif";if(t.bu){return "<div><img src='"+dP+"' style='top:"+cu+"px'></div>";}else{return "<img class='SB_Btn_Image' src='sysimage/space.gif' style='background-position: 0px "+cu+"px;background-image: url("+dP+");' />";}};var EWEBPagination=new Object();EWEBPagination.Insert=function(){if(config.PaginationMode=="0"){return false;}O.Focus();var R;if(V.bC()=="Control"){R=V.aW();}else{R=V.cX();}R=this.pk(R);if(!R){insertHTML("</P><P id=eWebEditor_Temp_P>");var p=O.J.getElementById("eWebEditor_Temp_P");p.removeAttribute("id");this.ed(p,"beforeBegin");}else{this.ed(R,"afterEnd");}};EWEBPagination.ed=function(R,kp){var ow=false;if(kp=="afterEnd"&&(!R.nextSibling)){ow=true;}var bx=O.J.createElement("img");bx.className="ewebeditor__pagination";bx.setAttribute("_ewebeditor_fake_tag","pagination");bx.setAttribute("src",O.cd+"/sysimage/space.gif");if(t.bu){R.insertAdjacentElement(kp,bx);}else{if(kp=="beforeBegin"){R.parentNode.insertBefore(bx,R);}else{R.parentNode.insertBefore(bx,R.nextSibling);}}if(ow){var p=O.J.createElement("p");R.parentElement.appendChild(p);}};EWEBPagination.pk=function(R){if(R.tagName=="HTML"){return null;}var ca=null;if(config.FixWidth){while(!((R.tagName.toUpperCase()=="DIV")&&(R.getAttribute("id")=="eWebEditor_FixWidth_DIV"))){ca=R;R=R.parentNode;if(!R|| !R.tagName){break;}}}else{while(R.tagName.toUpperCase()!="BODY"){ca=R;R=R.parentNode;if(!R|| !R.tagName){break;}}}return ca;};EWEBPagination.Auto=function(pu){if(config.PaginationMode=="0"){return false;}this.Empty();var kw=parseInt(pu);if(kw<1){return false;}if(getCount(2)<=kw){return false;}if(O.aj!="EDIT"){setMode("EDIT");}var cQ;if(config.FixWidth){cQ=O.J.getElementById("eWebEditor_FixWidth_DIV");}else{cQ=O.J.body;}var cn=cQ.childNodes;var l=0;for(var i=0;i<cn.length;i++){var aw=cn[i];if(aw.nodeType==1){var s=aw.innerText||aw.textContent;if(s){l+=s.length;}}else if(aw.nodeType==3){l+=aw.length;}if(l>=kw){if(aw.nextSibling){if(aw.nodeType==1){this.ed(aw,"afterEnd");}else{this.ed(aw.nextSibling,"beforeBegin");}l=0;}}}};EWEBPagination.Empty=function(){if(config.PaginationMode=="0"){return;}var bz=O.J.getElementsByTagName("IMG");for(var i=bz.length-1;i>=0;i--){var R=bz[i];var ce=R.getAttribute("_ewebeditor_fake_tag",2);if(ce){if(ce.toLowerCase()=="pagination"){H.dh(R);}}}};EWEBPagination.uW=function(){if(config.PaginationMode=="0"){return false;}var bz=O.J.getElementsByTagName("IMG");for(var i=bz.length-1;i>=0;i--){var R=bz[i];var ce=R.getAttribute("_ewebeditor_fake_tag",2);if(ce){if(ce.toLowerCase()=="pagination"){var ca=this.pk(R);if(ca){var b=false;if(ca.tagName=="DIV"||ca.tagName=="P"){var s=ca.innerText||ca.textContent;s=s.pd();if(!s){b=true;this.ed(ca,"beforeBegin");H.dh(ca);}}if(!b){this.ed(ca,"afterEnd");H.dh(R);}}}}}};var bo=new Object();bo.je=function(K){K=this.rN(K);K=this.jn(K,'script',/<script[\s\S]*?<\/script>/gi);K=this.jn(K,'noscript',/<noscript[\s\S]*?<\/noscript>/gi);K=this.jn(K,'comment',/<!--[\s\S]*?-->/g);K=this.rR(K);K=this.qe(K);K=this.sg(K);K=this.oV(K,"img","src");K=this.oV(K,"a","href");return K;};bo.uN=function(K){K=this.sS(K);K=this.sG(K);K=this.sR(K);K=this.rE(K);K=this.sK(K);return K;};bo.tN=function(){var R=V.aW();return R.getAttribute("_ewebeditor_fake_tag",2);};bo.jn=function(K,ae,ue){function _Replace(m){return bo.cJ(ae,m);};return K.replace(ue,_Replace);};bo.rE=function(K){function _Replace(m,ae){function gH(m,ah){if(['flash','flv','mediaplayer6','mediaplayer7','realplayer','quicktime','unknownobject'].eD(ae)>=0){var bE=bo.oW(m,'img');if(bE!=''){bE=' style='+bE;}var eY=(bo.nX(m,'img','width')=='')?bo.bZ(m,'img','width'):'';var eJ=(bo.nX(m,'img','height')=='')?bo.bZ(m,'img','height'):'';var gu=bo.bZ(m,'img','align');var iS=bo.bZ(m,'img','vspace');var gw=bo.bZ(m,'img','hspace');var dU=decodeURIComponent(ah);dU=bo.nB(dU,"object",bE);dU=bo.nB(dU,"embed",bE);dU=bo.rC(dU,["object","embed"],[["width",eY],["height",eJ],["align",gu],["vspace",iS],["hspace",gw]]);return dU;}else{return decodeURIComponent(ah);}};return m.replace(/<img [^>]*?_ewebeditor_fake_value=\"([^\">]+?)\"[^>]*?>/gi,gH);};return K.replace(/<img [^>]*?_ewebeditor_fake_tag=\"(\w+?)\"[^>]*?>/gi,_Replace);};bo.rN=function(K){if(config.PaginationMode=="0"){return K;}var aY='';var dM='';var dP=bo.cJ('pagination',"");if(config.PaginationMode=="1"){aY="";var bv=/<!--ewebeditor:page title=\"([^\">]*)\"-->((?:[^a]|a)+?)<!--\/ewebeditor:page-->/gi;var m;var iY=0;while((m=bv.exec(K))!=null){iY++;dM+=uQ(m[1])+"\r\n";if(aY!=""){aY+=dP;}aY+=m[2];}if(iY==0){aY=K;}}else{var bv=new RegExp(config.PaginationKey.replace(/([\[\]\{\}\.\(\)\*\+\?])/gi,"\\$1"),'gi');aY=K.replace(bv,dP);}$("D_PaginationTitle").value=dM;return aY;};bo.sS=function(K){if(config.PaginationMode=="0"){return K;}var aY=K;var a=K.split(/<img [^>]*?_ewebeditor_fake_tag=\"pagination\"[^>]*?>/gi);if(a.length>1){if(config.PaginationMode=="1"){aY="";var hS=$("D_PaginationTitle").value.split("\r\n");for(var i=0;i<a.length;i++){var dM="";if(hS[i]){dM=eK(hS[i]);}aY+="<!--ewebeditor:page title=\""+dM+"\"-->\r\n";aY+=a[i]+"\r\n";aY+="<!--/ewebeditor:page-->\r\n\r\n";}}else{aY=a[0];for(var i=1;i<a.length;i++){aY+="\r\n"+config.PaginationKey+"\r\n"+a[i];}}}return aY;};bo.rR=function(K){function _Replace(m){var es=m.replace(/<object [^>]*?classid\s*=\s*[\'\"]?clsid\s*:\s*([a-z0-9\-]+)[\'\"]?[^>]*?>[\s\S]*/gi,'$1');es=es.toUpperCase();if(es=='D27CDB6E-AE6D-11CF-96B8-444553540000'){if(/plugin\/flvplayer\.swf/.test(m)&&/flashvars[^>]*?\.flv/.test(m)){return bo.cJ('flv',m,'object');}else{return bo.cJ('flash',m,'object');}}else if(es=='22D6F312-B0F6-11D0-94AB-0080C74C7E95'){return bo.cJ('mediaplayer6',m,'object');}else if(es=='6BF52A52-394A-11D3-B153-00C04F79FAA6'){return bo.cJ('mediaplayer7',m,'object');}else if(es=='CFCDAA03-8BE4-11CF-B84B-0020AFBBCCFA'){return bo.cJ('realplayer',m,'object');}else if(es=='02BF25D5-8C17-4B23-BC80-D3488ABDDC6B'){return bo.cJ('quicktime',m,'object');}else{return bo.cJ('unknownobject',m,'object');}};return K.replace(/<object[\s\S]*?<\/object>/gi,_Replace);};bo.qe=function(K){function _Replace(m){var db=m.replace(/<embed [^>]*?type\s*=\s*[\'\"]?([^\'\"\s]+)[\'\"]?[^>]*?>[\s\S]*/gi,'$1');db=db.toLowerCase();if(db=='application/x-shockwave-flash'){return bo.cJ('flash',m,'embed');}else if(['application/x-mplayer2','video/x-ms-asf','video/x-msvideo','video/mpeg','audio/mid','audio/mpeg','audio/wav','video/x-ms-wm','audio/x-ms-wma','video/x-ms-wmv','video/x-ms-wmp','video/x-ms-wmx'].eD(db)>=0){return bo.cJ('mediaplayer6',m,'embed');}else if(db=='video/quicktime'){return bo.cJ('quicktime',m,'embed');}else if(['audio/x-pn-realaudio','audio/x-pn-realaudio-plugin','application/vnd.rn-realmedia'].eD(db)>=0){return bo.cJ('realplayer',m,'embed');}else{return bo.cJ('unknownobject',m,'embed');}};return K.replace(/<embed[\s\S]*?<\/embed>/gi,_Replace);};bo.cJ=function(ae,ah,ev){if(ev){var bE=bo.oW(ah,ev);var eY=bo.bZ(ah,ev,'width');var eJ=bo.bZ(ah,ev,'height');var gu=bo.bZ(ah,ev,'align');var iS=bo.bZ(ah,ev,'vspace');var gw=bo.bZ(ah,ev,'hspace');if(bE!=''){bE=' style='+bE;}var K='<img src="'+O.cd+'/sysimage/space.gif" class="ewebeditor__'+ae+'" _ewebeditor_fake_tag="'+ae+'" _ewebeditor_fake_value="'+encodeURIComponent(ah)+'"'+bE;if(eY!=''){K+=' width="'+eY+'"';}if(eJ!=''){K+=' height="'+eJ+'"';}if(gu!=''){K+=' align="'+gu+'"';}if(iS!=''){K+=' vspace="'+iS+'"';}if(gw!=''){K+=' hspace="'+gw+'"';}K+='>';return K;}else{return '<img src="'+O.cd+'/sysimage/space.gif" class="ewebeditor__'+ae+'" _ewebeditor_fake_tag="'+ae+'" _ewebeditor_fake_value="'+encodeURIComponent(ah)+'">';}};bo.oW=function(K,ae){var bv=new RegExp('^[\\s\\S]*?<'+ae+'(?=[\\s>])[^>]*?\\sstyle\\s*?=\\s*?(\'[^\'>]+?\'|\"[^\">]+?\")[^>]*?>[\\s\\S]*$','gi');if(bv.test(K)){return K.replace(bv,'$1');}else{return '';}};bo.nX=function(K,ae,al){var bv=new RegExp('^[\\s\\S]*?<'+ae+'(?=[\\s>])[^>]*?\\sstyle\\s*?=\\s*?([\'\"])[^>]*?\\b'+al+'\\s*?:\\s*?(\\w+)(?=[\\s\;\'\"])[^>]*?\\1[^>]*?>[\\s\\S]*$','gi');if(bv.test(K)){return K.replace(bv,'$2');}else{return '';}};bo.bZ=function(K,ae,al){var bv=new RegExp('^[\\s\\S]*?<'+ae+'(?=[\\s>])[^>]*?\\s'+al+'\\s*?=\\s*?([\'\"]?)(\\w+)\\1[^>]*?>[\\s\\S]*$','gi');if(bv.test(K)){return K.replace(bv,'$2');}else{return '';}};bo.nB=function(K,ae,bE){function _Replace(m){var r=/\sstyle\s*?=\s*?([\'\"])[^>]*?\1/gi;if(r.test(m)){bE=bE.replace('$','\\$');return m.replace(r,bE);}else{return m.substring(0,m.length-1)+bE+'>';}};var bv=new RegExp('<'+ae+'(?=[\\s>])[^>]*?>','gi');return K.replace(bv,_Replace);};bo.rC=function(K,gi,gG){for(var i=0;i<gi.length;i++){K=this.sj(K,gi[i],gG);}return K;};bo.sj=function(K,ae,gG){function _Replace(m){var al,hn;for(var i=0;i<gG.length;i++){al=gG[i][0];hn=gG[i][1];var s='';if(hn!=''){s=' '+al+'="'+hn+'"';}var r=new RegExp('\\s'+al+'\\s*?=\\s*?([\'\"]?)\\w+\\1','gi');if(r.test(m)){m=m.replace(r,s);}else{if(hn!=''){m=m.substring(0,m.length-1)+s+'>';}}}return m;};var bv=new RegExp('<'+ae+'[^>]*?>','gi');return K.replace(bv,_Replace);};bo.sg=function(K){function _Replace(m){function gE(m,al){return ' _ewebeditor_pa_'+al+'="'+encodeURIComponent(m)+'"';};return m.replace(/\s(on\w+)[\s\r\n]*=[\s\r\n]*?(\'|\")([\s\S]*?)\2/gi,gE);};return K.replace(/<[^\>]+ on\w+[\s\r\n]*=[\s\r\n]*?(\'|\")[\s\S]+?\>/gi,_Replace);};bo.sG=function(K){function _Replace(m,cV){return decodeURIComponent(cV);};return K.replace(/\s_ewebeditor_pa_\w+=\"([^\"]+)\"/gi,_Replace);};bo.oV=function(K,ae,al){function _Replace(m,cV,gs,hE,kS){var r=new RegExp('<'+ae+'[\\s\\r\\n]','gi');if(!r.test(m)||/_ewebeditor_ta_/.test(m)||/_ewebeditor_fake_/.test(m)){return m;}else{return cV+gs+' _ewebeditor_ta_'+al+'="'+encodeURIComponent(hE)+'"'+kS;}};var bv=new RegExp('(<'+ae+'[^>]*?)([\\s\\r\\n]'+al+'[\\s\\r\\n]*?=[\\s\\r\\n]*?[\'\"]([^>\'\"]*?)[\'\"])([\\s\\S]*?>)','gi');return K.replace(bv,_Replace);};bo.sR=function(K){function _Replace(m,al,ah){var r=new RegExp('[\\s\\r\\n]'+al+'[\\s\\r\\n]*?=[\\s\\r\\n]*?[\'\"][^>\'\"]*?[\'\"]','gi');var s=m.replace(r,'');r=new RegExp('\\s_ewebeditor_ta_'+al+'+\\s*?=\\s*?\"([^\"]*?)\"','gi');return s.replace(r,' '+al+'="'+decodeURIComponent(ah)+'"');};return K.replace(/<\w+[^>]*?_ewebeditor_ta_(\w+)\s*?=\s*?\"([^\">]*?)\"[^>]*>/gi,_Replace);};bo.sK=function(K){K=K.replace(/(<\w+(?=\s)[^>]*?\sclass\s*?=[^>]*?)(ewebeditor__\w+)([^>]*?>)/gi,'$1$3');K=K.replace(/(<\w+(?=\s)[^>]*?)(\sclass\s*?=\s*?\"\s*\")([^>]*>)/gi,'$1$3');return K;};var ub={un:function(K){var ke=this.sU();if(ke==''){return K;}var fJ=this.sc(K);var jN=new Array();var pB=/^\<\/(HTML|HEAD|BODY|FORM|TABLE|TBODY|THEAD|TR|UL|OL|DL)[ \>]/i;var qS=/^\<(HTML|HEAD|BODY|FORM|TABLE|TBODY|THEAD|TR|UL|OL|DL)[ \/\>]/i;var rg=new RegExp('^'+ke);var gH=function(m,cV,gs,hE,kS){jN.push(hE);return cV+fJ+kS;};var bv=/(<(style|script|pre)(?=[\s>])[^>]*?>)([\s\S]*?)(<\/\2>)/gi;K=K.replace(bv,gH);K=K.replace(/\<(P|DIV|H1|H2|H3|H4|H5|H6|ADDRESS|PRE|OL|UL|LI|DL|DT|DD|TITLE|META|LINK|BASE|SCRIPT|LINK|TD|TH|AREA|OPTION)[^\>]*\>/gi,'\n$&');K=K.replace(/\<\/(P|DIV|H1|H2|H3|H4|H5|H6|ADDRESS|PRE|OL|UL|LI|DL|DT|DD|TITLE|META|LINK|BASE|SCRIPT|LINK|TD|TH|AREA|OPTION)[^\>]*\>/gi,'$&\n');K=K.replace(/\<(BR|HR)[^\>]*\>/gi,'$&\n');K=K.replace(/\<\/?(HTML|HEAD|BODY|FORM|TABLE|TBODY|THEAD|TR)[^\>]*\>/gi,'\n$&\n');var mA=K.split(/\s*\n+\s*/g);var ij='';K='';for(var i=0;i<mA.length;i++){var iX=mA[i];if(iX.length==0){continue;}if(pB.test(iX)){ij=ij.replace(rg,'');}K+=ij+iX+'\n';if(qS.test(iX)){ij+=ke;}}var gE=function(m,cV,gs){return cV.toLowerCase()+gs;};K=K.replace(/(<\/?\w+(?=[\s>]))([^>]*?>)/gi,gE);var oE=K.split(fJ);K=oE[0];for(var i=0;i<jN.length;i++){K+=jN[i]+oE[i+1];}return K.pd();},sc:function(K){var fJ='__ewebeditor__sepstr__';var i=0;while(true){i=i+1;fJ=fJ+i;if(K.indexOf(fJ)<0){break;}}return fJ;},sU:function(){var n=parseInt(config.CodeFormat);var pa='';for(var i=0;i<n;i++){pa+=' ';}return pa;}};function gv(mW){for(var i=0;i<parent.frames.length;i++){if(parent.frames[i].document==self.document){var aa=parent.frames[i].frameElement;var ct=parseInt(aa.offsetHeight);if(ct+mW>=300){aa.height=ct+mW;}break;}}};function spellCheck(){if(!hH()){return;}try{var sI=new ActiveXObject("ieSpell.ieSpellExtension");sI.yC(O.J);}catch(xT){if(confirm(lang["MsgIeSpellDownload"])){window.open("http://www.iespell.com/download.php","IeSpellDownload");}}};function oy(){af('findreplace.htm',true);};function paragraphAttr(){if(!eG()){return;}O.Focus();if(!kN()){alert(lang["MsgNotParagraph"]);return;}af('paragraph.htm',true);};function kN(){if(V.bC()=="Control"){return false;}if(t.bu){var eW=O.J.selection.createRange();var cQ=O.J.body;var gD=cQ.getElementsByTagName("P");var fs=cQ.createTextRange();for(var i=0;i<gD.length;i++){fs.moveToElementText(gD[i]);if(eW.inRange(fs)){return true;}else{if(((eW.compareEndPoints("StartToEnd",fs)<0)&&(eW.compareEndPoints("StartToStart",fs)>0))||((eW.compareEndPoints("EndToStart",fs)>0)&&(eW.compareEndPoints("EndToEnd",fs)<0))){return true;}}}}else{var eW=O.aG.getSelection();var cQ=O.J.body;var gD=cQ.getElementsByTagName("P");for(var i=0;i<gD.length;i++){if(eW.containsNode(gD[i],true)){return true;}}}return false;};function xa(){if(!eG()){return;}EWEBHistory.Save();var b=false;if(V.bC()=="Control"){var bg=V.aW();if(bg.tagName.toUpperCase()=="IMG"){b=true;}}if(!b){alert(lang["MsgMapLimit"]);return;}af("map.htm",true);};function tG(){if(!eG()){return;}if(V.bC()=="Control"){var bg=V.aW();if(bg.tagName.toUpperCase()!="IMG"){alert(lang["MsgHylnkLimit"]);return;}}af("hyperlink.htm",true);};function insert(aT){if(!eG()){return;}O.Focus();EWEBHistory.Save();var bD;if(t.bu){var aM=O.J.selection.createRange();bD=aM.text;}else{bD=O.aG.getSelection().toString();}switch(aT){case "nowdate":var d=new Date();insertHTML(d.toLocaleDateString());break;case "nowtime":var d=new Date();insertHTML(d.toLocaleTimeString());break;case "br":insertHTML("<br>");break;case "code":insertHTML('<table width=95% border="0" align="Center" cellpadding="6" cellspacing="0" style="border: 1px Dotted #CCCCCC; TABLE-LAYOUT: fixed"><tr><td bgcolor=#FDFDDF style="WORD-WRAP: break-word"><font style="color: #990000;font-weight:bold">'+lang["HtmlCode"]+'</font><br>'+eK(bD)+'</td></tr></table>');break;case "quote":insertHTML('<table width=95% border="0" align="Center" cellpadding="6" cellspacing="0" style="border: 1px Dotted #CCCCCC; TABLE-LAYOUT: fixed"><tr><td bgcolor=#F3F3F3 style="WORD-WRAP: break-word"><font style="color: #990000;font-weight:bold">'+lang["HtmlQuote"]+'</font><br>'+eK(bD)+'</td></tr></table>');break;case "big":insertHTML("<big>"+bD+"</big>");break;case "small":insertHTML("<small>"+bD+"</small>");break;case "printbreak":insertHTML("<div style=\"FONT-SIZE: 1px; PAGE-BREAK-BEFORE: always; VERTICAL-ALIGN: middle; HEIGHT: 1px; BACKGROUND-COLOR: #c0c0c0\">&nbsp; </div>");break;default:alert(lang["ErrParam"]);break;}};var EWEBCommandZoom={Options:[10,25,50,75,100,150,200,500],oT:100,Execute:function(jb){if(t.bu){O.J.body.runtimeStyle.zoom=jb+"%";}else{O.J.body.style.MozTransform='scale('+(jb/100)+')';}this.oT=jb;}};function uo(){if(V.bC()!="Control"){return;}if(t.bu){var fp=O.J.selection.createRange();for(var i=0;i<fp.length;i++){var bg=fp.item(i);if(bg.style.position!='relative'){bg.style.position='relative';}else{bg.style.position='static';}}}else{var bg=V.aW();if(bg.style.position!='relative'){bg.style.position='relative';}else{bg.style.position='static';}}};function tj(ap){if(V.bC()!="Control"){return;}if(t.bu){var fp=O.J.selection.createRange();for(var i=0;i<fp.length;i++){var bg=fp.item(i);if(ap=='forward'){bg.style.zIndex+=1;}else{bg.style.zIndex-=1;}bg.style.position='relative';}}else{var bg=V.aW();if(ap=='forward'){bg.style.zIndex+=1;}else{bg.style.zIndex-=1;}bg.style.position='relative';}};function pJ(cK){V.eS();O.aG.focus();if(V.bC()!="Text"){return;}EWEBHistory.Save();if(t.bu){var aM=O.J.selection;var aX=aM.createRange();var r=O.J.body.createTextRange();var nj=0;while(r.compareEndPoints("StartToStart",aX)<0){r.moveStart("character",1);nj++;}var fj=0;while(r.compareEndPoints("EndToEnd",aX)>0){r.moveEnd("character",-1);fj--;}var a=["a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z"];var l,u,ge,hV;for(var i=0;i<26;i++){l=a[i];u=a[i].toUpperCase();switch(cK){case "uppercase":ge=l;hV=u;break;case "lowercase":ge=u;hV=l;break;}r=aX.duplicate();while(r.findText(ge,0,4)){r.text=hV;r=aX.duplicate();}}r=O.J.body.createTextRange();r.moveStart("character",nj);r.moveEnd("character",fj);r.select();}else{nC.oB(cK);}EWEBHistory.Save();};function fk(aT,fM){V.eS();O.aG.focus();if(V.bC()!="Text"){return;}EWEBHistory.Save();var oU="eWebEditor_Temp_FontName";if(t.bu){var r=O.J.selection.createRange();var qm=r.getBookmark();O.J.execCommand("fontname","",oU);var kL=O.J.body.getElementsByTagName("FONT");var bi=new Array();for(var i=0;i<kL.length;i++){var dJ=kL[i];if(dJ.getAttribute("face")==oU){bi[bi.length]=kL[i];}}for(var i=0;i<bi.length;i++){var dJ=bi[i];oZ(dJ,aT);lz(dJ);mE(dJ,aT,fM);dJ.removeAttribute("face");var aJ=dJ.parentElement;if(aJ.tagName=="FONT"){mU(aJ);}if((aJ.tagName=="FONT")||(aJ.tagName=="SPAN")){if(aJ.innerText==dJ.innerText){aJ.style.cssText=aJ.style.cssText+";"+dJ.style.cssText;aJ.innerHTML=dJ.innerHTML;continue;}}}r.moveToBookmark(qm);r.select();}else{if(["uppercase","lowercase","size"].eD(aT)>=0){nC.oB(aT,fM);}else{if(aT=="face"){aT="fontName";}O.J.execCommand(aT,false,fM);}}};function oZ(F,aT){mZ(F,aT,"");var aP=F.children;for(var j=0;j<aP.length;j++){oZ(aP[j],aT);if(aP[j].tagName=="FONT"){mU(aP[j]);}}};function lz(F){var aP=F.children;for(var j=0;j<aP.length;j++){lz(aP[j]);if((aP[j].tagName=="FONT")||(aP[j].tagName=="SPAN")){if((aP[j].style.cssText==""&&aP[j].className=="")||(aP[j].innerHTML=="")){aP[j].removeNode(false);lz(F);return;}}}};function mE(F,aT,v){mZ(F,aT,v);var aP=F.children;for(var j=0;j<aP.length;j++){if((aP[j].tagName=="SPAN")||(aP[j].tagName=="FONT")){mE(aP[j],aT,v);}}};function mZ(F,aT,v){try{switch(aT){case "face":F.style.fontFamily=v;break;case "size":F.style.fontSize=v;break;case "color":F.style.color=v;break;default:break;}}catch(e){}};function mU(R){if(R.style.fontFamily==""){var s=R.getAttribute("face");if(s){R.style.fontFamily=s;}}R.removeAttribute("face");if(R.style.fontSize==""){var s=R.getAttribute("size");s=mn(s);if(s){R.style.fontSize=s;}}R.removeAttribute("size");if(R.style.color==""){var s=R.getAttribute("color");if(s){R.style.color=s;}}R.removeAttribute("color");};var nC=(function(){var jB,ju,gF,hw;var aZ=[];var by,ef,dc,dw,fD,kW,jU;return{oB:function(bJ,fM){if(V.bC()!="Text"){return;}ju=false;jB=false;aZ.length=0;gF=bJ;hw=fM;fD=(gF=="uppercase"||gF=="lowercase")?true:false;kW=false;jU=false;var aM=O.aG.getSelection();var aX=aM.getRangeAt(0);by=aX.startContainer;ef=aX.endContainer;dc=aX.startOffset;dw=aX.endOffset;if(by.isSameNode(ef)){if(by.nodeType==1&&by.tagName=="BODY"){kW=true;ef=this.oO(by);by=this.pr(by);if(!by|| !ef){return;}dc=0;dw=ef.nodeValue.length;this.jw(aX.startContainer);}else{jU=true;var hA=by.nodeValue;if(fD){by.nodeValue=hA.substring(0,dc)+this.hh(hA.substring(dc,dw))+hA.substring(dw);}else{O.J.execCommand("inserthtml",false,this.hh(hA.substring(dc,dw)));}}}else{this.jw(aX.commonAncestorContainer);}if(kW){O.J.execCommand("SelectAll",false,null);}else{if(fD){aX.setStart(by,dc);aX.setEnd(ef,dw);}else{if(jU){var kb=O.J.getElementById("eWebEditor_Temp_Span_FontSize");if(kb){kb.removeAttribute("id");aX.selectNodeContents(kb.firstChild);}}else{aX.setStart(by,by.nodeValue.length);aX.setEnd(ef,0);}}}aM.removeAllRanges();aM.addRange(aX);O.Focus();},jw:function(R){if(R.isSameNode(by)){ju=true;}if(ju){if(R.isSameNode(by)){if(fD){R.nodeValue=R.nodeValue.substring(0,dc)+this.hh(R.nodeValue.substring(dc));}else{aZ[aZ.length]=R;}}else if(R.isSameNode(ef)){if(fD){R.nodeValue=this.hh(R.nodeValue.substring(0,dw))+R.nodeValue.substring(dw);}else{aZ[aZ.length]=R;for(var i=0;i<aZ.length;i++){if(aZ[i].nodeValue==""){continue;}if(i==0){var ak=aZ[i].parentNode;if((ak.tagName.toUpperCase()=="SPAN")&&(aZ[i].nodeValue.substring(dc)==ak.innerHTML)){this.gq(ak);}else{var bx=this.iO(aZ[i].nodeValue.substring(dc));ak.insertBefore(bx,aZ[i].nextSibling);aZ[i].nodeValue=aZ[i].nodeValue.substring(0,dc);}}else if(i==aZ.length-1){var ak=aZ[i].parentNode;if((ak.tagName.toUpperCase()=="SPAN")&&(aZ[i].nodeValue.substring(0,dw)==ak.innerHTML)){this.gq(ak);}else{var bx=this.iO(aZ[i].nodeValue.substring(0,dw));ak.insertBefore(bx,aZ[i]);aZ[i].nodeValue=aZ[i].nodeValue.substring(dw);}}else{var ak=aZ[i].parentNode;if((ak.tagName.toUpperCase()=="SPAN")&&(aZ[i].nodeValue==ak.innerHTML)){this.gq(ak);}else{var bx=this.iO(aZ[i].nodeValue);ak.replaceChild(bx,aZ[i]);}}}}jB=true;}else if(R.nodeType==3){if(fD){R.nodeValue=this.hh(R.nodeValue);}else{aZ[aZ.length]=R;}}}if(R.hasChildNodes()){for(var i=0;i<R.childNodes.length;i++){if(jB){return;}this.jw(R.childNodes[i]);}}},hh:function(av){switch(gF){case "uppercase":return av.toUpperCase();break;case "lowercase":return av.toLowerCase();break;case "size":return "<span id=\"eWebEditor_Temp_Span_FontSize\" style=\"font-size:"+hw+"\">"+av+"</span>";break;}},iO:function(bD){var jR=O.J.createElement("span");var uj=O.J.createTextNode(bD);jR.appendChild(uj);this.gq(jR);return jR;},gq:function(R){switch(gF){case "size":R.style.fontSize=hw;break;case "face":R.style.fontName=hw;break;}},pr:function(R){if(R.nodeType==3){return R;}if(R.hasChildNodes()){for(var i=0;i<R.childNodes.length;i++){var aw=this.pr(R.childNodes[i]);if(aw){return aw;}}}return null;},oO:function(R){var aw;if(R.nodeType==3){aw=R;}if(R.hasChildNodes()){for(var i=0;i<R.childNodes.length;i++){var nb=this.oO(R.childNodes[i]);if(nb){aw=nb;}}}if(aw){return aw;}else{return null;}}};})();var EWEBCommandJustify={Execute:function(aT){var b=false;if(aT=="justifyleft"||aT=="justifycenter"||aT=="justifyright"){if(V.bC()=="Control"){var bg=V.aW();try{if(aT=="justifycenter"){bg.align="";bg.style.display="block";bg.style.margin="0px auto";bg.style.textAlign=s;}else{bg.align=aT.substr(7);bg.style.display="";bg.style.margin="";bg.style.textAlign="";}b=true;}catch(e){}}}if(!b){var p=this.rX(["P","DIV","TD","TH"]);if(p){if(aT=="justifyfull"){p.style.textAlign="";p.style.textJustify="inter-ideograph";}else{p.style.textAlign=aT.substr(7);p.style.textJustify="";}}else{O.J.execCommand(aT,false,null);}}},rX:function(gi){var R=null;if(V.bC()!="Control"){R=V.cX();if(R.tagName=="HTML"){return null;}while(gi.eD(R.tagName.toUpperCase())<0){if(R.tagName.toUpperCase()=="BODY"){R=null;break;}R=R.parentNode;}}return R;}};var EWEBCommandCopyCut=new Object();EWEBCommandCopyCut.Execute=function(aT){var ku=false;if(t.bu){var mY=function(){ku=true;};var pp='on'+aT.toLowerCase();O.J.body.attachEvent(pp,mY);O.J.execCommand(aT,false,null);O.J.body.detachEvent(pp,mY);}else{try{O.J.execCommand(aT,false,null);ku=true;}catch(e){}}if(!ku){alert(lang['MsgSafe'+aT]);}};var EWEBCommandMaximize=new Object();EWEBCommandMaximize.Execute=function(){var aa=window.frameElement;var ln=parent.document.documentElement;var iP=parent.document.body.style;var aJ;if(!this.lb){if(t.bu){parent.attachEvent('onresize',fU);}else{parent.addEventListener('resize',fU,true);}this.nM=H.gT(parent);aJ=aa;while((aJ=aJ.parentNode)){if(aJ.nodeType==1){aJ._ewebSavedStyles=H.mk(aJ);aJ.style.zIndex=9998;}}if(t.bu){this.tk=ln.style.overflow;ln.style.overflow='hidden';iP.overflow='hidden';}else{iP.overflow='hidden';iP.width='0px';iP.height='0px';}this.pZ=H.mk(aa);var ht=H.gN(parent);aa.style.position="absolute";aa.offsetLeft;aa.style.zIndex=9998;aa.style.left="0px";aa.style.top="0px";aa.style.width=ht.Width+"px";aa.style.height=ht.Height+"px";if(!t.bu){aa.style.borderRight=aa.style.borderBottom="9999px solid white";aa.style.backgroundColor="white";}parent.scrollTo(0,0);var gz=H.tm(parent,aa);if(gz.x!=0){aa.style.left=(-1*gz.x)+"px";}if(gz.y!=0){aa.style.top=(-1*gz.y)+"px";}this.lb=true;}else{if(t.bu){parent.detachEvent("onresize",fU);}else{parent.removeEventListener("resize",fU,true);}aJ=aa;while((aJ=aJ.parentNode)){if(aJ._ewebSavedStyles){H.ox(aJ,aJ._ewebSavedStyles);aJ._ewebSavedStyles=null;}}if(t.bu){ln.style.overflow=this.tk;}H.ox(aa,this.pZ);parent.scrollTo(this.nM.X,this.nM.Y);this.lb=false;}this.dX();if(O.aj=="EDIT"&& !t.bu){O.jY();}O.Focus();};EWEBCommandMaximize.dX=function(){var dA=dK.iU("other","Maximize");for(var j=0;j<dA.length;j++){var R=dA[j];if(this.lb){R.cN="on";R.className="TB_Btn_Down";}else{R.cN=null;R.className="TB_Btn";}}};function fU(){var ht=H.gN(parent);var aa=window.frameElement;aa.style.width=ht.Width+'px';aa.style.height=ht.Height+'px';};function tp(){if(!hH()){return;}if(!fv(true)){return;}aI.Capture("");window.setTimeout("lG()",100);};function lG(){try{if(aI.Status!="ok"){window.setTimeout("lG()",100);return;}}catch(e){return}if(aI.Error=="cancel"){return;}if(eE()){return;}var eO=aI.Body;insertHTML(eO);aI=null;};function pN(){if(config.AutoDetectPaste=="2"){window.setTimeout("pasteText()",10);return;}if(t.bu){if(config.AutoDetectPaste=="1"){if(!fv(true)){return false;}var ap=aI.GetClipboardFlag();aI=null;var gM=ap.split("|");if(gM[5]=="1"){window.setTimeout("pasteWord()",10);return false;}else if(gM[5]=="2"){window.setTimeout("pasteExcel()",10);return false;}else if(gM[0]=="1"||gM[3]=="1"){window.setTimeout("PasteOption('"+ap+"')",10);return false;}}pf();}else{try{O.J.execCommand("paste",false,null);}catch(e){af("pastegecko.htm");}}};function pf(){var K=sb();insertHTML(K);};function PasteOption(ap){af("pasteoption.htm?flag="+ap,true);};function pasteWord(){af("importword.htm?action=paste",true);};function pasteExcel(){af("importexcel.htm?action=paste",true);};function pasteText(){O.Focus();EWEBHistory.Save();if(t.bu){var K=eK(clipboardData.getData("Text"));insertHTML(K);}else{af("pastegecko.htm?action=text");}EWEBHistory.Save();O.Focus();};function sb(){var fC=$("eWebEditor_Temp_HTML");fC.innerHTML="";var mD=document.body.createTextRange();mD.moveToElementText(fC);mD.execCommand("Paste");var K=fC.innerHTML;fC.innerHTML="";return K;};var EWEBCommandShowBorders={Execute:function(){this.fi();this.du= !this.du;this.dX();},jG:function(){this.fi();if(this.du){this.dX();}},fi:function(){if(typeof(this.du)=="undefined"){this.du=(config.ShowBorder=="0")?false:true;}},dX:function(){var bz=O.J.getElementsByTagName("TABLE");for(var i=0;i<bz.length;i++){var R=bz[i];if(this.du){R.className+=' ewebeditor__showtableborders';}else{R.className=R.className.replace(/(^| )ewebeditor__showtableborders/gi,'');}}var dA=dK.iU("other","ShowBorders");for(var j=0;j<dA.length;j++){var R=dA[j];if(this.du){R.cN="on";R.className="TB_Btn_Down";}else{R.cN=null;R.className="TB_Btn";}}}};var EWEBCommandShowBlocks={Execute:function(){this.fi();this.du= !this.du;this.dX();},jG:function(){this.fi();if(this.du){this.dX();}},fi:function(){if(typeof(this.du)=="undefined"){this.du=(config.ShowBlock=="1")?true:false;}},dX:function(){var cQ=O.J.body;if(this.du){cQ.className+=' ewebeditor__showblocks';}else{cQ.className=cQ.className.replace(/(^| )ewebeditor__showblocks/gi,'');}var dA=dK.iU("other","ShowBlocks");for(var j=0;j<dA.length;j++){var R=dA[j];if(this.du){R.cN="on";R.className="TB_Btn_Down";}else{R.cN=null;R.className="TB_Btn";}}}};function pK(ap){if(!hH()){return;}switch(ap){case "word":af('importword.htm',true);break;case "excel":af('importexcel.htm',true);break;}};var EWEBCommandForm={Insert:function(ap){switch(ap){case "inputtext":insertHTML('<input type="text">');break;case "textarea":insertHTML('<textarea></textarea>');break;case "radio":insertHTML('<input type="radio">');break;case "checkbox":insertHTML('<input type="checkbox">');break;case "select":insertHTML('<select></select>');break;case "button":insertHTML('<input type="button">');break;}}};function wN(){O.aG.print();};var H=new Object();H.eN=function(document){return("CSS1Compat"==(document.compatMode||(t.iT?"CSS1Compat":null)));};H.fS=function(bG){bG.style.cssText="margin:0;"+"padding:0;"+"border:0;"+"background-color:transparent;"+"background-image:none;";};H.fg=function(bG){return bG.ownerDocument||bG.document;};H.nI=function(bG){return this.tz(this.fg(bG));};H.tz=function(document){if(t.iT&& !document.parentWindow){this.nH(window.top);}return document.parentWindow||document.defaultView;};H.nH=function(eA){if(eA.document){eA.document.parentWindow=eA;}for(var i=0;i<eA.frames.length;i++){H.nH(eA.frames[i]);}};H.og=function(){var ey=window.parent;while(ey.parent&&ey.parent!=ey){try{if(ey.parent.document.domain!=document.domain){break;}if(ey.parent.document.getElementsByTagName("frameset").length>0){break;}}catch(e){break;}ey=ey.parent;}return ey;};H.jc=function(w,node){var x=0;var y=0;var bS=node;var km=null;var hB=H.nI(bS);while(bS&& !(hB==w&&(bS==w.document.body||bS==w.document.documentElement))){x+=bS.offsetLeft-bS.scrollLeft;y+=bS.offsetTop-bS.scrollTop;if(!t.kU){var eB=km;while(eB&&eB!=bS){x-=eB.scrollLeft;y-=eB.scrollTop;eB=eB.parentNode;}}km=bS;if(bS.offsetParent){bS=bS.offsetParent;}else{if(hB!=w){bS=hB.frameElement;km=null;if(bS){hB=bS.contentWindow.parent;}}else{bS=null;}}}if(H.aU(w.document.body,'position')!='static'||(t.bu&&H.uh(node)==null)){x+=w.document.body.offsetLeft;y+=w.document.body.offsetTop;}return{"x":x,"y":y};};H.tm=function(w,node){var pos=this.jc(w,node);var scroll=H.gT(w);pos.x-=scroll.X;pos.y-=scroll.Y;return pos;};H.yG=function(bG,sP){var window=this.nI(bG);var oX=this.gN(window).Height;var offset=oX* -1;if(sP===false){offset+=bG.offsetHeight||0;offset+=parseInt(this.aU(bG,'marginBottom')||0,10)||0;}var sy=this.jc(window,bG);offset+=sy.y;var pj=this.gT(window).Y;if(offset>0&&(offset>pj||offset<pj-oX)){window.scrollTo(0,offset);}};H.mI=function(cF){if(!cF||cF.nodeType!=1||cF.tagName.toLowerCase()!='form'){return[];}var ft=[];var pn=['style','className'];for(var i=0;i<pn.length;i++){var name=pn[i];if(cF.elements.namedItem(name)){var kk=cF.elements.namedItem(name);ft.push([kk,kk.nextSibling]);cF.removeChild(kk);}}return ft;};H.pi=function(cF,ft){if(!cF||cF.nodeType!=1||cF.tagName.toLowerCase()!='form'){return;}if(ft.length>0){for(var i=ft.length-1;i>=0;i--){var node=ft[i][0];var mp=ft[i][1];if(mp){cF.insertBefore(node,mp);}else{cF.appendChild(node);}}}};H.uh=function(bG){var bW=bG;while(bW!=H.fg(bW).documentElement){if(this.aU(bW,'position')!='static'){return bW;}if(bW==H.fg(bW).documentElement&&sB!=w){bW=sB.frameElement;}else{bW=bW.parentNode;}}return null;};H.mR=function(hI,sr,gg,ji,kx){return(kx||window).setTimeout(function(){if(ji){hI.apply(gg,[].concat(ji));}else{hI.apply(gg);}},sr);};H.xE=function(hI,gg,ji,kx){if(hI){this.mR(hI,0,gg,ji,kx);}};H.dB=function(bG,lQ){var style=bG.style;for(var nm in lQ){style[nm]=lQ[nm];}};H.dh=function(node,uY){if(uY){var nx;while((nx=node.firstChild)){node.parentNode.insertBefore(node.removeChild(nx),node);}}return node.parentNode.removeChild(node);};H.uR=function(aw,lh){while(aw&&aw.tagName&&aw.tagName!="BODY"){if(aw.tagName.toUpperCase()==lh){return aw;}aw=aw.parentNode;}return null;};var V=new Object();H.oJ=function(eA){eA.$=function(id){return eA.document.getElementById(id);};};H.ib=function(){return "javascript: void(0);";};H.as=function(e){if(e){e.preventDefault();e.stopPropagation();}};H.bM=function(jM,kV,hL){jM.addEventListener(kV,hL,false);};H.nT=function(jM,kV,hL){jM.removeEventListener(kV,hL,false);};H.gN=function(win){return{Width:win.innerWidth,Height:win.innerHeight};};H.gT=function(ov){return{X:ov.pageXOffset,Y:ov.pageYOffset};};H.tu=function(bG,opacity){bG.style.opacity=opacity;};H.aU=function(bG,propertyName){return bG.ownerDocument.defaultView.getComputedStyle(bG,"").getPropertyValue(propertyName);};H.iy=function(bG){if(t.jW){bG.style.MozUserSelect='-moz-none';}else if(t.iT){bG.style.KhtmlUserSelect='none';}else{bG.style.userSelect='none';}var bz=bG.getElementsByTagName("*");for(var i=0;i<bz.length;i++){switch(bz[i].tagName){case "INPUT":case "TEXTAREA":bz[i].style.MozUserSelect="text";break;default:}}};H.mk=function(bG){var data=H.mI(bG);var iR=new Object();if(bG.className.length>0){iR.Class=bG.className;bG.className='';}var lA=bG.getAttribute('style');if(lA&&lA.length>0){iR.Inline=lA;bG.setAttribute('style','',0);}H.pi(bG,data);return iR;};H.ox=function(bG,kO){var data=H.mI(bG);bG.className=kO.Class||'';if(kO.Inline){bG.setAttribute('style',kO.Inline,0);}else{bG.removeAttribute('style',0);}H.pi(bG,data);};V.bC=function(){var type='Text';var vv={img:1,hr:1,li:1,table:1,tr:1,td:1,embed:1,object:1,ol:1,ul:1};var aM;try{aM=this.bd();}catch(e){}if(aM&&aM.rangeCount==1){var range=aM.getRangeAt(0);if(range.startContainer==range.endContainer&&(range.endOffset-range.startOffset)==1&&range.startContainer.nodeType==1&&vv[range.startContainer.childNodes[range.startOffset].nodeName.toLowerCase()]){type='Control';}}return type;};V.aW=function(){var selection= ! !O.aG&&this.bd();if(!selection||selection.rangeCount<1){return null;}var range=selection.getRangeAt(0);if(range.startContainer!=range.endContainer||range.startContainer.nodeType!=1||range.startOffset!=range.endOffset-1){return null;}var node=range.startContainer.childNodes[range.startOffset];if(node.nodeType!=1){return null;}return node;};V.cX=function(){if(this.bC()=='Control'){return V.aW().parentNode;}else{var aA=this.bd();if(aA){var oRange=aA.getRangeAt(0);if(aA.anchorNode&&aA.anchorNode==aA.focusNode){if(oRange.collapsed||oRange.startContainer.nodeType==3){return aA.anchorNode.parentNode;}else{return aA.anchorNode;}}return oRange.commonAncestorContainer;}}return null;};V.xq=function(qC){if(!O.aG){return null;}if(this.bC()=='Control'){return V.aW().parentNode;}else{var aA=this.bd();if(aA&&aA.rangeCount>0){var range=aA.getRangeAt(qC?0:(aA.rangeCount-1));var bG=qC?range.startContainer:range.endContainer;return(bG.nodeType==1?bG:bG.parentNode);}}return null;};V.vd=function(bG){var oRange=O.J.createRange();oRange.selectNode(bG);var aA=this.bd();aA.removeAllRanges();aA.addRange(oRange);};V.Collapse=function(oS){var aA=this.bd();if(oS==null||oS===true){aA.collapseToStart();}else{aA.collapseToEnd();}};V.yk=function(ie){var co=this.aW();if(!co&&O.aG){try{co=this.bd().getRangeAt(0).startContainer;}catch(e){}}while(co){if(co.nodeType==1&&co.nodeName.wA(ie))return true;co=co.parentNode;}return false;};V.xP=function(ie){var jx;var co=this.aW();if(!co){co=this.bd().getRangeAt(0).startContainer;}while(co){if(co.nodeName.wA(ie)){return co;}co=co.parentNode;}return null;};V.Delete=function(){var aA=this.bd();for(var i=0;i<aA.rangeCount;i++){aA.getRangeAt(i).deleteContents();}return aA;};V.bd=function(){return O.aG.getSelection();};V.Save=function(){};V.eS=function(){};V.pG=function(){};